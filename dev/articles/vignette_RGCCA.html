<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The RGCCA package for Regularized/Sparse Generalized Canonical Correlation Analysis • RGCCA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The RGCCA package for Regularized/Sparse Generalized Canonical Correlation Analysis">
<meta property="og:description" content="RGCCA">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RGCCA</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">2.1.3.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignette_RGCCA.html">The RGCCA package for Regularized/Sparse Generalized Canonical Correlation Analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/llrs/RGCCA/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="vignette_RGCCA_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>The RGCCA package for Regularized/Sparse Generalized Canonical Correlation Analysis</h1>
            
            <h4 class="date">2021-04-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/llrs/RGCCA/blob/master/vignettes/vignette_RGCCA.Rmd"><code>vignettes/vignette_RGCCA.Rmd</code></a></small>
      <div class="hidden name"><code>vignette_RGCCA.Rmd</code></div>

    </div>

    
    

<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>A challenging problem in multivariate statistics is to study relationships between several sets of variables measured on the same set of individuals. In the literature, this paradigm can be stated under several names as “learning from multimodal data”, “data integration”, “data fusion” or “multiblock data analysis”. Typical examples are found in large variety of fields such as biology, chemistry, sensory analysis, marketing, food research, where the common general objective is to identify variables of each block that are active in the relationships with other blocks. For instance, neuroimaging is increasingly recognised as an intermediate phenotype to understand the complex path between genetics and behavioural or clinical phenotypes. In this imaging-genetics context, the goal is primarily to identify a set of genetic biomarker that explains some neuroimaging variability which implies some modification of the behavioural. A second application is found in molecular biology where the completion of the human genome sequence has shifted research efforts in genomics toward understanding the effect of sequence variation on gene expression, protein function, or other cellular mechanims. Both in the imaging-genetics and the multi-modal genetic context, it is crucial to perform multiple experiments (e.g. SNPs, functional MRI, behavioural data) on a single set of patients and the joint analysis of multiple datasets becomes more and more crucial. The RGCCA package aims to propose a unified and flexible framework for that purpose.</p>
</div>
<div id="multiblock-data-analysis-with-the-rgcca-package" class="section level1">
<h1 class="hasAnchor">
<a href="#multiblock-data-analysis-with-the-rgcca-package" class="anchor"></a>Multiblock data analysis with the RGCCA package</h1>
<p>For the sake of comprehension of the use of the RGCCA package, the theoretical fundations of RGCCA and variations - that were previously published <span class="citation">(Tenenhaus and Tenenhaus 2011 ; A. Tenenhaus and Tenenhaus 2014 ; Arthur Tenenhaus, Philippe, and Frouin 2015 ; Tenenhaus, Tenenhaus, and Groenen 2017)</span> - are described.</p>
<p>We consider <span class="math inline">\(J\)</span> data matrices <span class="math inline">\(\mathbf{X}_1, \ldots, \mathbf{X}_J\)</span>. Each <span class="math inline">\(n \times p_j\)</span> data matrix <span class="math inline">\(\mathbf{X}_j = [\ensuremath{\mathbf{x}}_{j1}, \ldots, \ensuremath{\mathbf{x}}_{jp_j}]\)</span> is called a block and represents a set of <span class="math inline">\(p_j\)</span> variables observed on <span class="math inline">\(n\)</span> individuals. The number and the nature of the variables may differ from one block to another, but the individuals must be the same across blocks. We assume that all variables are centered. The objective of RGCCA is to find, for each block, a weighted composite of variables (called block component) <span class="math inline">\(\mathbf{y}_j= \mathbf{X}_j \ensuremath{\mathbf{a}}_j,j=1, \ldots,J\)</span> (where <span class="math inline">\(\ensuremath{\mathbf{a}}_j\)</span> is a column-vector with <span class="math inline">\(p_j\)</span> elements) summarizing the relevant information between and within the blocks. The block components are obtained such that (i) block components explain well their own block and/or (ii) block components that are assumed to be connected are highly correlated. In addition, RGCCA integrates a variable selection procedure, called SGCCA, allowing the identification of the most relevant features. Finally, as a component-based method, RGCCA/SGCCA can provide users with graphical representations to visualize the sources of variability within blocks and the amount of correlation between blocks.</p>
<div id="regularized-generalized-canonical-correlation-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#regularized-generalized-canonical-correlation-analysis" class="anchor"></a>Regularized Generalized Canonical Correlation Analysis</h2>
<p>The second generation RGCCA <span class="citation">(Tenenhaus, Tenenhaus, and Groenen 2017)</span> subsumes fifty years of multiblock component methods. It provides important improvements to the initial version of RGCCA <span class="citation">(Tenenhaus and Tenenhaus 2011)</span> and is defined as the following optimization problem:</p>
<p><span class="math display">\[\begin{equation}
\displaystyle \underset{\ensuremath{\mathbf{a}}_1,\ensuremath{\mathbf{a}}_2, \ldots,\ensuremath{\mathbf{a}}_J}{\text{maximize}} \sum_{j, k = 1}^J c_{jk}g(\mathrm{cov}(\mathbf{X}_j\ensuremath{\mathbf{a}}_j, \mathbf{X}_k\ensuremath{\mathbf{a}}_k)) \mathrm{~~s.t.~~} (1-\tau_j)\mathrm{var}(\mathbf{X}_j\ensuremath{\mathbf{a}}_j) + \tau_j\Vert \ensuremath{\mathbf{a}}_j \Vert^2 = 1, j=1, \ldots,J
\label{optim_RGCCA}
\end{equation}\]</span></p>
<p>where:</p>
<ul>
<li><p>The scheme function <span class="math inline">\(g\)</span> is any continuous convex function and allows to consider different optimization criteria. Typical choices of <span class="math inline">\(g\)</span> are the identity (horst scheme, leading to maximizing the sum of covariances between block components), the absolute value (centroid scheme, yielding maximization of the sum of the absolute values of the covariances), the square function (factorial scheme, thereby maximizing the sum of squared covariances), or, more generally, for any even integer <span class="math inline">\(m\)</span>, <span class="math inline">\(g(x) = x^m\)</span> (m-scheme, maximizing the power of <span class="math inline">\(m\)</span> of the sum of covariances). The horst scheme penalizes structural negative correlation between block components while both the centroid scheme and the m-scheme enable two components to be negatively correlated. According to <span class="citation">(Van de Geer 1984)</span>, a fair model is a model where all blocks contribute equally to the solution in opposition to a model dominated by only a few of the <span class="math inline">\(J\)</span> sets. If fairness is a major objective, the user must choose <span class="math inline">\(m=1\)</span>. <span class="math inline">\(m&gt;1\)</span> is preferable if the user wants to discriminate between blocks. In practice, <span class="math inline">\(m\)</span> is equal to <span class="math inline">\(1\)</span>, <span class="math inline">\(2\)</span> or <span class="math inline">\(4\)</span>. The higher the value of <span class="math inline">\(m\)</span> the more the method acts as block selector <span class="citation">(Tenenhaus, Tenenhaus, and Groenen 2017)</span>.</p></li>
<li><p>The design matrix <span class="math inline">\(\ensuremath{\mathbf{C}}\)</span> is a symmetric <span class="math inline">\(J \times J\)</span> matrix of nonnegative elements describing the network of connections between blocks that the user wants to take into account. Usually, <span class="math inline">\(c_{jk}=1\)</span> for two connected blocks and 0 otherwise.</p></li>
<li>
<p>The <span class="math inline">\(\tau_j\)</span> are called shrinkage parameters ranging from <span class="math inline">\(0\)</span> to <span class="math inline">\(1\)</span> and interpolate smoothly between maximizing the covariance and maximizing the correlation. Setting the <span class="math inline">\(\tau_j\)</span> to 0 will force the block components to unit variance (<span class="math inline">\(\mathrm{var}(\mathbf{X}_j\ensuremath{\mathbf{a}}_j = 1)\)</span>), in which case the covariance criterion boils down to the correlation. The correlation criterion is better in explaining the correlated structure across datasets, thus discarding the variance within each individual dataset. Setting <span class="math inline">\(\tau_j\)</span> to 1 will normalize the block weight vectors (<span class="math inline">\(\ensuremath{\mathbf{a}}_j^\top\ensuremath{\mathbf{a}}_j = 1\)</span> ), which applies the covariance criterion. A value between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span> will lead to a compromise between the two first options and correspond to the following constraint <span class="math inline">\((1-\tau_j)\mathrm{var}(\mathbf{X}_j\ensuremath{\mathbf{a}}_j) + \tau_j \Vert \ensuremath{\mathbf{a}}_j \Vert^2 = 1\)</span> in (). The choices <span class="math inline">\(\tau_j = 1\)</span>, <span class="math inline">\(\tau_j = 0\)</span> and <span class="math inline">\(0&lt;\tau_j&lt;1\)</span> are respectively referred as Modes A, B and Ridge. In the RGCCA package, for each block, the determination of the shrinkage parameter can be made fully automatic by using the analytical formula proposed by <span class="citation">(Schäfer and Strimmer 2005)</span>. Also, depending on the context, the shrinkage parameters should also be determined based on V-fold cross-validation. We can define the choice of the shrinkage parameters by providing interpretations on the properties of the resulting block components:</p>
<ul>
<li>
<span class="math inline">\(\tau_j=1\)</span> yields the maximization of a covariance-based criterion. It is recommended when the user wants a stable component (large variance) while simultaneously taking into account the correlations between blocks. The user must, however, be aware that variance dominates over correlation.</li>
<li>
<span class="math inline">\(\tau_j=0\)</span> yields the maximization of a correlation-based criterion. It is recommended when the user wants to maximize correlations between connected components. This option can yield unstable solutions in case of multi-collinearity and cannot be used when a data block is rank deficient (e.g. <span class="math inline">\(n&lt;p_j\)</span>).</li>
<li>
<span class="math inline">\(0&lt;\tau_j&lt;1\)</span> is a good compromise between variance and correlation: the block components are simultaneously stable and as well correlated as possible with their connected block components. This setting can be used when the data block is rank deficient.</li>
</ul>
</li>
</ul>
<p>From optimization problem (), the term “generalized” in the acronym of RGCCA embraces at least three notions. The first one relates to the generalization of two-block methods - including Canonical Correlation Analysis <span class="citation">(Hotelling 1936)</span> Interbattery Factor Analysis <span class="citation">(Tucker 1958)</span> and Redundancy Analysis <span class="citation">(Van den Wollenberg 1977)</span> - to three or more sets of variables. The second one relates to the ability of taking into account some hypotheses on between-block connections: the user decides which blocks are connected and which ones are not. The third one relies on the choices of the shrinkage parameters allowing to capture both correlation or covariance-based criteria.</p>
</div>
<div id="variable-selection-in-rgcca-sgcca" class="section level2">
<h2 class="hasAnchor">
<a href="#variable-selection-in-rgcca-sgcca" class="anchor"></a>Variable selection in RGCCA: SGCCA</h2>
<p>The quality and interpretability of the RGCCA block components <span class="math inline">\(\mathbf{y}_j= \mathbf{X}_j \ensuremath{\mathbf{a}}_j,j=1, \ldots,J\)</span> are likely affected by the usefulness and relevance of the variables of each block. Accordingly, it is an important issue to identify within each block a subset of significant variables which are active in the relationships between blocks. SGCCA extends RGCCA to address this issue of variable selection. Specifically, RGCCA with all <span class="math inline">\(\tau_j=1\)</span> equal to 1 is combined with an L1-penalty that gives rise to SGCCA <span class="citation">(A. Tenenhaus et al. 2014)</span>. The SGCCA optimization problem is defined as follows:</p>
<p><span class="math display">\[\begin{equation}
\displaystyle \underset{\mathbf{a}_1,\mathbf{a}_2, \ldots,\mathbf{a}_J}{\text{maximize}} \sum_{j, k = 1}^J c_{jk}g(\mathrm{cov}(\mathbf{X}_j\ensuremath{\mathbf{a}}_j, \mathbf{X}_k\ensuremath{\mathbf{a}}_k)) \mathrm{~~s.t.~~} \Vert \mathbf{a}_j \Vert_2 = 1 \text{~and~} \Vert \mathbf{a}_j \Vert_1 \le s_j, j=1,\ldots,J
\label{optim_SGCCA}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(s_j\)</span> is a user defined positive constant that determines the amount of sparsity for <span class="math inline">\(\ensuremath{\mathbf{a}}_j, j=1, \ldots,J\)</span>. The smaller the <span class="math inline">\(s_j\)</span>, the larger the degree of sparsity for <span class="math inline">\(\ensuremath{\mathbf{a}}_j\)</span>. The sparsity parameter <span class="math inline">\(s_j\)</span> is usually set based on cross-validation procedures. Alternatively, values of <span class="math inline">\(s_j\)</span> can simply be chosen to result in desired amounts of sparsity.</p>
</div>
<div id="higher-stage-block-components" class="section level2">
<h2 class="hasAnchor">
<a href="#higher-stage-block-components" class="anchor"></a>Higher stage block components</h2>
<p>It is possible to obtain more than one block-component per block for RGCCA and SGCCA. Higher stage block components can be obtained using a deflation strategy. This strategy forces all the block components within a block to be uncorrelated. This deflation procedure can be iterated in a very flexible way. It is not necessary to keep all the blocks in the procedure at all stages: the number of components summarizing a block can vary from one block to another (see <span class="citation">(Tenenhaus, Tenenhaus, and Groenen 2017)</span> for details).</p>
</div>
<div id="implementation" class="section level2">
<h2 class="hasAnchor">
<a href="#implementation" class="anchor"></a>Implementation</h2>
<p>The function <code><a href="../reference/rgcca.html">rgcca()</a></code>of the RGCCA package implements a monotonically convergent algorithm for the optimization problem () - i.e. the bounded criterion to be maximized increases at each step of the iterative procedure -, which hits at convergence a stationary point of (). Two numerically equivalent approaches for solving the RGCCA optimization problem are available. A primal formulation described in <span class="citation">(Tenenhaus, Tenenhaus, and Groenen 2017 ; Tenenhaus and Tenenhaus 2011)</span> requires the handling of matrices of dimension <span class="math inline">\(p_j \times p_j\)</span>. A dual formulation described in <span class="citation">(Arthur Tenenhaus, Philippe, and Frouin 2015)</span> requires the handling of matrices of dimension <span class="math inline">\(n \times n\)</span> . Therefore, the primal formulation of the RGCCA algorithm will be used when <span class="math inline">\(n&gt;p_j\)</span> and the dual form will be preferred when <span class="math inline">\(n\le p_j\)</span> . The <code><a href="../reference/rgcca.html">rgcca()</a></code> function of the RGCCA package implements these two formulations and selects automatically the best one. The SGCCA algorithm is similar to the RGCCA algorithm and keeps the same convergence properties. The algorithm associated with the optimization problem (2) is available through the function <code><a href="../reference/sgcca.html">sgcca()</a></code> of the RGCCA package.</p>
</div>
<div id="special-cases-of-rgcca" class="section level2">
<h2 class="hasAnchor">
<a href="#special-cases-of-rgcca" class="anchor"></a>Special cases of RGCCA</h2>
<p>RGCCA is a rich technique that encompasses a large number of multiblock methods that were published for fifty years. These methods are recovered with RGCCA by appropriately defining the triplet (<span class="math inline">\(\ensuremath{\mathbf{C}}\)</span>, <span class="math inline">\(\tau_j\)</span>, <span class="math inline">\(g\)</span>). Table 1 gives the correspondences between the triplet (<span class="math inline">\(\ensuremath{\mathbf{C}}\)</span>, <span class="math inline">\(\tau_j\)</span>, <span class="math inline">\(g\)</span>) and the associated methods. For a complete overview see <span class="citation">(Tenenhaus, Tenenhaus, and Groenen 2017)</span>.</p>
<table class="table">
<caption>Special cases of RGCCA in a situation of <span class="math inline">\(J \ge 2\)</span> blocks. When <span class="math inline">\(\tau_J+1\)</span> is introduced, it is assumed that <span class="math inline">\(\ensuremath{\mathbf{X}}_1, \ldots, \ensuremath{\mathbf{X}}_J\)</span> are connected to a <span class="math inline">\((J + 1)\)</span>th block defined as the concatenation of the blocks, <span class="math inline">\(\ensuremath{\mathbf{X}}_{J+1} = \bigg[\ensuremath{\mathbf{X}}_1 , \ensuremath{\mathbf{X}}_2, \ldots, \ensuremath{\mathbf{X}}_J \bigg]\)</span> and that <span class="math inline">\(\tau_{J+1}\)</span> corresponds to the shrinkage parameter associated with <span class="math inline">\(\ensuremath{\mathbf{X}}_{J+1}\)</span>.</caption>
<colgroup>
<col width="31%">
<col width="8%">
<col width="33%">
<col width="27%">
</colgroup>
<thead><tr class="header">
<th><strong>Methods</strong></th>
<th><span class="math inline">\(g(x)\)</span></th>
<th><span class="math inline">\(\tau_j\)</span></th>
<th><span class="math inline">\(\ensuremath{\mathbf{C}}\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>
<strong>Canonical Correlation Analysis</strong> <span class="citation">(Hotelling 1936)</span>
</td>
<td><span class="math inline">\(x\)</span></td>
<td><span class="math inline">\(\tau_1 = \tau_2 = 0\)</span></td>
<td><span class="math inline">\(\ensuremath{\mathbf{C}}_1 = \begin{pmatrix} 0 &amp; 1 \\ 1 &amp; 0 \end{pmatrix}\)</span></td>
</tr>
<tr class="even">
<td>
<strong>Interbattery Factor Analysis</strong> <span class="citation">(Tucker 1958)</span>
</td>
<td><span class="math inline">\(x\)</span></td>
<td><span class="math inline">\(\tau_1 = \tau_2 = 1\)</span></td>
<td><span class="math inline">\(\ensuremath{\mathbf{C}}_1\)</span></td>
</tr>
<tr class="odd">
<td>
<strong>Redundancy Analysis</strong> <span class="citation">(Van den Wollenberg 1977)</span>
</td>
<td><span class="math inline">\(x\)</span></td>
<td>
<span class="math inline">\(\tau_1 = 1\)</span> and <span class="math inline">\(\tau_2 = 0\)</span>
</td>
<td><span class="math inline">\(\ensuremath{\mathbf{C}}_1\)</span></td>
</tr>
<tr class="even">
<td>
<strong>SUMCOR</strong> <span class="citation">(Horst 1961)</span>
</td>
<td><span class="math inline">\(x\)</span></td>
<td><span class="math inline">\(\tau_j = 0, j=1, \ldots, J\)</span></td>
<td><span class="math inline">\(\ensuremath{\mathbf{C}}_2 = \begin{pmatrix} 1 &amp; 1 &amp; \cdots &amp; 1 \\ 1 &amp; 1 &amp; \ddots &amp; \vdots \\ \vdots &amp; \ddots&amp; \ddots &amp; 1\\ 1 &amp; \cdots &amp; 1 &amp; 1 \end{pmatrix}\)</span></td>
</tr>
<tr class="odd">
<td>
<strong>SSQCOR</strong> <span class="citation">(Kettenring 1971)</span>
</td>
<td><span class="math inline">\(x^2\)</span></td>
<td><span class="math inline">\(\tau_j = 0, 1 \le j \le J\)</span></td>
<td><span class="math inline">\(\ensuremath{\mathbf{C}}_2\)</span></td>
</tr>
<tr class="even">
<td>
<strong>SABSCOR</strong> <span class="citation">(Hanafi 2007)</span>
</td>
<td>$abs(x) $</td>
<td><span class="math inline">\(\tau_j = 0, 1 \le j \le J\)</span></td>
<td><span class="math inline">\(\ensuremath{\mathbf{C}}_2\)</span></td>
</tr>
<tr class="odd">
<td>
<strong>SUMCOV-1</strong> <span class="citation">(Van de Geer 1984)</span>
</td>
<td><span class="math inline">\(x\)</span></td>
<td><span class="math inline">\(\tau_j = 1, 1 \le j \le J\)</span></td>
<td><span class="math inline">\(\ensuremath{\mathbf{C}}_2\)</span></td>
</tr>
<tr class="even">
<td>
<strong>SSQCOV-1</strong> <span class="citation">(Hanafi and Kiers 2006)</span>
</td>
<td><span class="math inline">\(x^2\)</span></td>
<td><span class="math inline">\(\tau_j = 1, 1 \le j \le J\)</span></td>
<td><span class="math inline">\(\ensuremath{\mathbf{C}}_2\)</span></td>
</tr>
<tr class="odd">
<td>
<strong>SABSCOV-1</strong> <span class="citation">(Tenenhaus and Tenenhaus 2011 ; Kramer 2007)</span>
</td>
<td><span class="math inline">\(abs(x)\)</span></td>
<td><span class="math inline">\(\tau_j = 1, 1 \le j \le J\)</span></td>
<td><span class="math inline">\(\ensuremath{\mathbf{C}}_2\)</span></td>
</tr>
<tr class="even">
<td>
<strong>SUMCOV-2</strong> <span class="citation">(Van de Geer 1984)</span>
</td>
<td><span class="math inline">\(x\)</span></td>
<td><span class="math inline">\(\tau_j = 0, 1 \le j \le J\)</span></td>
<td><span class="math inline">\(\ensuremath{\mathbf{C}}_3 = \begin{pmatrix} 0 &amp; 1 &amp; \cdots &amp; 1 \\ 1 &amp; 0 &amp; \ddots &amp; \vdots\\ \vdots &amp; \ddots&amp; \ddots&amp; 1\\ 1 &amp; \cdots &amp; 1 &amp; 0 \end{pmatrix}\)</span></td>
</tr>
<tr class="odd">
<td>
<strong>SSQCOV-2</strong> <span class="citation">(Hanafi and Kiers 2006)</span>
</td>
<td><span class="math inline">\(x^2\)</span></td>
<td><span class="math inline">\(\tau_j = 1, 1 \le j \le J\)</span></td>
<td><span class="math inline">\(\ensuremath{\mathbf{C}}_3\)</span></td>
</tr>
<tr class="even">
<td>
<strong>Generalized CCA</strong> <span class="citation">(J.D. Carroll 1968)</span>
</td>
<td><span class="math inline">\(x^2\)</span></td>
<td><span class="math inline">\(\tau_j = 0, 1 \le j \le J+1\)</span></td>
<td><span class="math inline">\(\ensuremath{\mathbf{C}}_4 = \begin{pmatrix} 0 &amp; \cdots &amp; 0 &amp; 1 \\ \vdots &amp; \ddots &amp; \vdots &amp; \vdots\\ 0 &amp; \cdots &amp; 0 &amp; 1\\ 1 &amp; \cdots &amp; 1 &amp; 0 \end{pmatrix}\)</span></td>
</tr>
<tr class="odd">
<td>
<strong>Generalized CCA</strong> <span class="citation">(JD Carroll 1968)</span>
</td>
<td><span class="math inline">\(x^2\)</span></td>
<td>
<span class="math inline">\(\tau_j=0, 0 \leq j \leq J_1 = 0 ~\&amp;~\tau_{J+1} = 0\)</span> and <span class="math inline">\(\tau_j = 1, J_1+1 \leq j \leq J\)</span>
</td>
<td><span class="math inline">\(\ensuremath{\mathbf{C}}_4\)</span></td>
</tr>
<tr class="even">
<td>
<strong>Hierarchical PCA</strong> <span class="citation">(Wold, S. and Kettaneh, N. and Tjessem, K. 1996)</span>
</td>
<td><span class="math inline">\(x^4\)</span></td>
<td>
<span class="math inline">\(\tau_j = 1, 1 \le j \le J\)</span> and <span class="math inline">\(\tau_{J+1} = 0\)</span>
</td>
<td><span class="math inline">\(\ensuremath{\mathbf{C}}_4\)</span></td>
</tr>
<tr class="odd">
<td>
<strong>Multiple Co-Inertia Analysis</strong> <span class="citation">(Chessel and Hanafi 1996)</span>
</td>
<td><span class="math inline">\(x^2\)</span></td>
<td>
<span class="math inline">\(\tau_j = 1, 1 \le j \le J\)</span> and <span class="math inline">\(\tau_{J+1} = 0\)</span>
</td>
<td><span class="math inline">\(\ensuremath{\mathbf{C}}_4\)</span></td>
</tr>
<tr class="even">
<td>
<strong>PLS path modeling - mode B</strong> <span class="citation">(Wold 1982)</span>
</td>
<td><span class="math inline">\(abs(x)\)</span></td>
<td><span class="math inline">\(\tau_j = 0, 1 \le j \le J\)</span></td>
<td>
<span class="math inline">\(c_{jk}=1\)</span> for two connected block and <span class="math inline">\(c_{jk} = 0\)</span> otherwise</td>
</tr>
</tbody>
</table>
<p>For all the methods of Table 1, a single very simple monotonically convergent gradient-based algorithm is implemented within the RGCCA package and gives at convergence a solution of the stationary equations related to the optimization problem (). In addition, SGCCA offers a sparse counterpart to all the covariance-based methods of RGCCA. From these perspectives, R/SGCCA provide a general framework for exploratory data analysis of multiblock datasets that has immediate practical consequences for a unified statistical analysis and implementation strategy.</p>
<p>The methods cited in Table 1 are recovered with the <code><a href="../reference/rgcca.html">rgcca()</a></code> function by appropriately tuning the arguments <code>C</code>, <code>tau</code> and <code>scheme</code> associated with the triplet (<span class="math inline">\(\ensuremath{\mathbf{C}}\)</span>, <span class="math inline">\(\tau_j\)</span>, <span class="math inline">\(g\)</span>). All the methods of Table 1 are obtained as follows:</p>
<div id="principal-component-analysis-" class="section level3">
<h3 class="hasAnchor">
<a href="#principal-component-analysis-" class="anchor"></a>Principal Component Analysis.</h3>
<p>Principal Component Analysis is defined as the following optimization problem</p>
<p><span class="math display">\[\begin{equation}
\underset{\ensuremath{\mathbf{a}}}{\text{maximize}} \text{~~var}\left(\mathbf{X}\ensuremath{\mathbf{a}} \right) \mathrm{~s.t.~} \Vert \ensuremath{\mathbf{a}} \Vert = 1
\label{PCA1}
\end{equation}\]</span></p>
<p>and is obtained with the <code><a href="../reference/rgcca.html">rgcca()</a></code> function as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># one block X </span>
<span class="co"># Design matrix C</span>
<span class="co"># Shrinkage parameters tau = c(tau1, tau2)</span>

<span class="va">pca.with.rgcca</span> <span class="op">=</span> <span class="fu"><a href="../reference/rgcca.html">rgcca</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">X</span><span class="op">)</span>, 
                       C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,
                       tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="canonical-correlation-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#canonical-correlation-analysis" class="anchor"></a>Canonical Correlation Analysis</h3>
<p>Canonical Correlation Analysis is defined as the following optimization problem</p>
<p><span class="math display">\[\begin{equation}
\underset{\ensuremath{\mathbf{a}}_1, \ensuremath{\mathbf{a}}_2}{\text{maximize}} \text{
~~cor}\left(\mathbf{X}_1\ensuremath{\mathbf{a}}_1, \mathbf{X}_2\ensuremath{\mathbf{a}}_2 \right) \mathrm{~s.t.~} \text{var}(\mathbf{X}_1\ensuremath{\mathbf{a}}_1) = \text{var}(\mathbf{X}_2\ensuremath{\mathbf{a}}_2) = 1
\label{CCA}
\end{equation}\]</span></p>
<p>and is obtained with the <code><a href="../reference/rgcca.html">rgcca()</a></code> function as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># X1 = Block1 and X2 = Block2 </span>
<span class="co"># Design matrix C</span>
<span class="co"># Shrinkage parameters tau = c(tau1, tau2)</span>

<span class="va">cca.with.rgcca</span> <span class="op">=</span> <span class="fu"><a href="../reference/rgcca.html">rgcca</a></span><span class="op">(</span>A<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">X2</span><span class="op">)</span>, 
                       C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,
                       tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="pls-regression-approx-interbattery-factor-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#pls-regression-approx-interbattery-factor-analysis" class="anchor"></a>PLS regression (<span class="math inline">\(\approx\)</span> Interbattery factor analysis)</h3>
<p>PLS regression is defined as the following optimization problem</p>
<p><span class="math display">\[\begin{equation}
\underset{\ensuremath{\mathbf{a}}_1, \ensuremath{\mathbf{a}}_2}{\text{maximize}} \text{
~~cov}\left(\mathbf{X}_1\ensuremath{\mathbf{a}}_1, \mathbf{X}_2\ensuremath{\mathbf{a}}_2 \right) \mathrm{~s.t.~} \Vert \ensuremath{\mathbf{a}}_1 \Vert = \Vert \ensuremath{\mathbf{a}}_2 \Vert = 1
\label{PLS}
\end{equation}\]</span></p>
<p>and is obtained with the <code><a href="../reference/rgcca.html">rgcca()</a></code> function as follows:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># X1 = Block1 and X2 = Block2 </span>
<span class="co"># Design matrix C</span>
<span class="co"># Shrinkage parameters tau = c(tau1, tau2)</span>

<span class="va">pls.with.rgcca</span> <span class="op">=</span> <span class="fu"><a href="../reference/rgcca.html">rgcca</a></span><span class="op">(</span>A<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">X2</span><span class="op">)</span>, 
                       C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,
                       tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="redundancy-analysis-of-mathbfx_1-with-respect-to-mathbfx_2" class="section level3">
<h3 class="hasAnchor">
<a href="#redundancy-analysis-of-mathbfx_1-with-respect-to-mathbfx_2" class="anchor"></a>Redundancy Analysis of <span class="math inline">\(\mathbf{X}_1\)</span> with respect to <span class="math inline">\(\mathbf{X}_2\)</span>
</h3>
<p>Redundancy Analysis of <span class="math inline">\(\mathbf{X}_1\)</span> with respect to <span class="math inline">\(\mathbf{X}_2\)</span> is defined as the following optimization problem</p>
<p><span class="math display">\[\begin{equation}
\underset{\ensuremath{\mathbf{a}}_1, \ensuremath{\mathbf{a}}_2}{\text{maximize}} \text{
~~cor}\left(\mathbf{X}_1 \ensuremath{\mathbf{a}}_1, \mathbf{X}_2 \ensuremath{\mathbf{a}}_2 \right) \times \text{
var}\left(\mathbf{X}_1\ensuremath{\mathbf{a}}_1\right)^{1/2} \mathrm{~s.t.~} \Vert \ensuremath{\mathbf{a}}_1 \Vert = \text{var}(\mathbf{X}_2\ensuremath{\mathbf{a}}_2) = 1
\label{RA}
\end{equation}\]</span></p>
<p>and is obtained with the <code><a href="../reference/rgcca.html">rgcca()</a></code> function as follows:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># X1 = Block1 and X2 = Block2 </span>
<span class="co"># Design matrix C</span>
<span class="co"># Shrinkage parameters tau = c(tau1, tau2)</span>

<span class="va">ra.with.rgcca</span> <span class="op">=</span> <span class="fu"><a href="../reference/rgcca.html">rgcca</a></span><span class="op">(</span>A<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">X2</span><span class="op">)</span>, 
                       C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,
                       tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="regularized-canonical-correlation-analysis-vinod1976-shawe2004" class="section level3">
<h3 class="hasAnchor">
<a href="#regularized-canonical-correlation-analysis-vinod1976-shawe2004" class="anchor"></a>Regularized Canonical Correlation Analysis <span class="citation">(Vinod 1976 ; Shawe-Taylor and Cristianini 2004)</span>
</h3>
<p>Regularized Canonical Correlation Analysis is defined as the following optimization problem</p>
<p><span class="math display">\[\begin{equation}
\underset{\ensuremath{\mathbf{a}}_1, \ensuremath{\mathbf{a}}_2}{\text{maximize}} \text{
~~cov}\left(\mathbf{X}_1\ensuremath{\mathbf{a}}_1, \mathbf{X}_2\ensuremath{\mathbf{a}}_2 \right) \mathrm{~s.t.~} \tau_j
\Vert \ensuremath{\mathbf{a}}_j \Vert^2 + (1-\tau_j)\text{var}(\mathbf{X}_j\ensuremath{\mathbf{a}}_j) = 1, j =1,2
\label{rCCA}
\end{equation}\]</span></p>
<p>and is obtained with the <code><a href="../reference/rgcca.html">rgcca()</a></code> function as follows:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># X1 = Block1 and X2 = Block2 </span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co"># Design matrix C</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co"># Shrinkage parameters tau = c(tau1, tau2)</span></span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a>rcca.with.rgcca =<span class="st"> </span><span class="kw">rgcca</span>(<span class="dt">A=</span> <span class="kw">list</span>(X1, X2), </span>
<span id="cb5-6"><a href="#cb5-6"></a>                       <span class="dt">C =</span> <span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb5-7"><a href="#cb5-7"></a>                       <span class="dt">tau =</span> <span class="kw">c</span>(<span class="dv">0</span><span class="op">&lt;</span>tau1<span class="op">&lt;</span><span class="dv">1</span>, <span class="dv">0</span><span class="op">&lt;</span>tau2<span class="op">&lt;</span><span class="dv">1</span>))</span></code></pre></div>
<p>For various extreme cases <span class="math inline">\(\tau_1 = 0\)</span> or <span class="math inline">\(1\)</span> and <span class="math inline">\(\tau_2 = 0\)</span> or <span class="math inline">\(1\)</span>, optimization problem () covers a situation which goes from Tucker’s interbattery factor analysis to Canonical Correlation Analysis while passing through redundancy analysis. This framework corresponds exactly to the one proposed by <span class="citation">(Borga, Landelius, and Knutsson 1997)</span> and <span class="citation">(Burnham, Viveros, and MacGregor 1996)</span>. Moreover, the special situation where <span class="math inline">\(0 \le \tau_1 \le 1\)</span> and <span class="math inline">\(\tau_2 = 0\)</span> which corresponds to a regularized version of redundancy analysis has been studied by <span class="citation">(Takane and Hwang 2007)</span> and by <span class="citation">(Bougeard, Hanafi, and Qannari 2008)</span> under the name “Continuum redundancy-PLS regression”. When one block is reduced to only one variable, optimization problem () is equivalent to the simple continuum regression approach proposed by <span class="citation">(Qannari and Hanafi 2005)</span>.</p>
</div>
<div id="sumcov-1" class="section level3">
<h3 class="hasAnchor">
<a href="#sumcov-1" class="anchor"></a>SUMCOV-1</h3>
<p>SUMCOV-1 is defined as the following optimization problem</p>
<p><span class="math display">\[\begin{equation}
\underset{\ensuremath{\mathbf{a}}_1, \ensuremath{\mathbf{a}}_2, \ldots,\ensuremath{\mathbf{a}}_J} {\text{maximize}} \displaystyle \sum_{j, k = 1}^J \text{cov}(\ensuremath{\mathbf{X}}_j\ensuremath{\mathbf{a}}_j, \ensuremath{\mathbf{X}}_k\ensuremath{\mathbf{a}}_k) \text{~~s.t~~} \Vert \ensuremath{\mathbf{a}}_j \Vert = 1, j=1, \ldots, J
\end{equation}\]</span></p>
<p>and is obtained with the <code><a href="../reference/rgcca.html">rgcca()</a></code> function as follows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># X1 = Block1, ..., XJ = BlockJ</span>
<span class="co"># J*J Design matrix C</span>
<span class="co"># Shrinkage parameters tau = c(tau1, ...,  tauJ)</span>

<span class="va">sumcov.with.rgcca</span> <span class="op">=</span> <span class="fu"><a href="../reference/rgcca.html">rgcca</a></span><span class="op">(</span>A<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">...</span>, <span class="va">XJ</span><span class="op">)</span>, 
                       C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">J</span>, <span class="va">J</span><span class="op">)</span>,
                       tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">J</span><span class="op">)</span>,
                       scheme <span class="op">=</span> <span class="st">"horst"</span><span class="op">)</span></code></pre></div>
</div>
<div id="ssqcov-1" class="section level3">
<h3 class="hasAnchor">
<a href="#ssqcov-1" class="anchor"></a>SSQCOV-1</h3>
<p>SSQCOV-1 is defined as the following optimization problem</p>
<p><span class="math display">\[\begin{equation}
\underset{\ensuremath{\mathbf{a}}_1, \ensuremath{\mathbf{a}}_2, \ldots,\ensuremath{\mathbf{a}}_J} {\text{maximize}} \displaystyle \sum_{j, k = 1}^J \text{cov}^2(\ensuremath{\mathbf{X}}_j\ensuremath{\mathbf{a}}_j, \ensuremath{\mathbf{X}}_k\ensuremath{\mathbf{a}}_k) \text{~~s.t~~} \Vert \ensuremath{\mathbf{a}}_j \Vert = 1, j=1, \ldots, J
\end{equation}\]</span></p>
<p>and is obtained with the <code><a href="../reference/rgcca.html">rgcca()</a></code> function as follows:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># X1 = Block1, ..., XJ = BlockJ</span>
<span class="co"># J*J Design matrix C</span>
<span class="co"># Shrinkage parameters tau = c(tau1, ...,  tauJ)</span>

<span class="va">ssqcov.with.rgcca</span> <span class="op">=</span> <span class="fu"><a href="../reference/rgcca.html">rgcca</a></span><span class="op">(</span>A<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">...</span>, <span class="va">XJ</span><span class="op">)</span>, 
                       C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">J</span>, <span class="va">J</span><span class="op">)</span>,
                       tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">J</span><span class="op">)</span>,
                       scheme <span class="op">=</span> <span class="st">"factorial"</span><span class="op">)</span></code></pre></div>
</div>
<div id="sabscov" class="section level3">
<h3 class="hasAnchor">
<a href="#sabscov" class="anchor"></a>SABSCOV</h3>
<p>SABSCOV is defined as the following optimization problem</p>
<p><span class="math display">\[\begin{equation}
\underset{\ensuremath{\mathbf{a}}_1, \ensuremath{\mathbf{a}}_2, \ldots,\ensuremath{\mathbf{a}}_J} {\text{maximize}} \displaystyle \sum_{j, k = 1}^J \vert \text{cov}(\ensuremath{\mathbf{X}}_j\ensuremath{\mathbf{a}}_j, \ensuremath{\mathbf{X}}_k\ensuremath{\mathbf{a}}_k) \vert \text{~~s.t~~} \Vert \ensuremath{\mathbf{a}}_j \Vert = 1, j=1, \ldots, J
\end{equation}\]</span></p>
<p>and is obtained with the <code><a href="../reference/rgcca.html">rgcca()</a></code> function as follows:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># X1 = Block1, ..., XJ = BlockJ</span>
<span class="co"># J*J Design matrix C</span>
<span class="co"># Shrinkage parameters tau = c(tau1, ...,  tauJ)</span>

<span class="va">sabscov.with.rgcca</span> <span class="op">=</span> <span class="fu"><a href="../reference/rgcca.html">rgcca</a></span><span class="op">(</span>A<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">...</span>, <span class="va">XJ</span><span class="op">)</span>, 
                       C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">J</span>, <span class="va">J</span><span class="op">)</span>,
                       tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">J</span><span class="op">)</span>,
                       scheme <span class="op">=</span> <span class="st">"centroid"</span><span class="op">)</span></code></pre></div>
</div>
<div id="sumcor" class="section level3">
<h3 class="hasAnchor">
<a href="#sumcor" class="anchor"></a>SUMCOR</h3>
<p>SUMCOR is defined as the following optimization problem</p>
<p><span class="math display">\[\begin{equation}
\underset{\ensuremath{\mathbf{a}}_1, \ensuremath{\mathbf{a}}_2, \ldots,\ensuremath{\mathbf{a}}_J} {\text{maximize}} \displaystyle \sum_{j, k = 1}^J \text{cor}(\ensuremath{\mathbf{X}}_j\ensuremath{\mathbf{a}}_j, \ensuremath{\mathbf{X}}_k\ensuremath{\mathbf{a}}_k) \text{~~s.t~~} \text{var}(\mathbf{X}_j \ensuremath{\mathbf{a}}_j) = 1, j=1, \ldots, J
\end{equation}\]</span></p>
<p>and is obtained with the <code><a href="../reference/rgcca.html">rgcca()</a></code> function as follows:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># X1 = Block1, ..., XJ = BlockJ</span>
<span class="co"># J*J Design matrix C</span>
<span class="co"># Shrinkage parameters tau = c(tau1, ...,  tauJ)</span>

<span class="va">sumcor.with.rgcca</span> <span class="op">=</span> <span class="fu"><a href="../reference/rgcca.html">rgcca</a></span><span class="op">(</span>A<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">...</span>, <span class="va">XJ</span><span class="op">)</span>, 
                       C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">J</span>, <span class="va">J</span><span class="op">)</span>,
                       tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">J</span><span class="op">)</span>,
                       scheme <span class="op">=</span> <span class="st">"horst"</span><span class="op">)</span></code></pre></div>
</div>
<div id="ssqcor" class="section level3">
<h3 class="hasAnchor">
<a href="#ssqcor" class="anchor"></a>SSQCOR</h3>
<p>SSQCOR is defined as the following optimization problem</p>
<p><span class="math display">\[\begin{equation}
\underset{\ensuremath{\mathbf{a}}_1, \ensuremath{\mathbf{a}}_2, \ldots,\ensuremath{\mathbf{a}}_J} {\text{maximize}} \displaystyle \sum_{j, k = 1; k \ne j}^J  \text{cor}^2(\ensuremath{\mathbf{X}}_j\ensuremath{\mathbf{a}}_j, \ensuremath{\mathbf{X}}_k\ensuremath{\mathbf{a}}_k) \text{~~s.t~~} \text{var}(\mathbf{X}_j \ensuremath{\mathbf{a}}_j) = 1, j=1, \ldots, J
\end{equation}\]</span></p>
<p>and is obtained with the <code><a href="../reference/rgcca.html">rgcca()</a></code> function as follows:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># X1 = Block1, ..., XJ = BlockJ</span>
<span class="co"># J*J Design matrix C</span>
<span class="co"># Shrinkage parameters tau1, ...,  tauJ</span>

<span class="va">ssqcor.with.rgcca</span> <span class="op">=</span> <span class="fu"><a href="../reference/rgcca.html">rgcca</a></span><span class="op">(</span>A<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">...</span>, <span class="va">XJ</span><span class="op">)</span>, 
                       C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">J</span>, <span class="va">J</span><span class="op">)</span>,
                       tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">J</span><span class="op">)</span>,
                       scheme <span class="op">=</span> <span class="st">"factorial"</span><span class="op">)</span></code></pre></div>
</div>
<div id="sabscor" class="section level3">
<h3 class="hasAnchor">
<a href="#sabscor" class="anchor"></a>SABSCOR</h3>
<p>SABSCOR is defined as the following optimization problem</p>
<p><span class="math display">\[\begin{equation}
\underset{\ensuremath{\mathbf{a}}_1, \ensuremath{\mathbf{a}}_2, \ldots,\ensuremath{\mathbf{a}}_J} {\text{maximize}} \displaystyle \sum_{j, k = 1}^J \vert \text{cor}(\ensuremath{\mathbf{X}}_j\ensuremath{\mathbf{a}}_j, \ensuremath{\mathbf{X}}_k\ensuremath{\mathbf{a}}_k) \vert \text{~~s.t~~} \text{var}(\mathbf{X}_j \ensuremath{\mathbf{a}}_j) = 1, j=1, \ldots, J
\end{equation}\]</span></p>
<p>and is obtained with the <code><a href="../reference/rgcca.html">rgcca()</a></code> function as follows:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># X1 = Block1, ..., XJ = BlockJ</span>
<span class="co"># J*J Design matrix C</span>
<span class="co"># Shrinkage parameters tau = c(tau1, ...,  tauJ)</span>

<span class="va">sabscor.with.rgcca</span> <span class="op">=</span> <span class="fu"><a href="../reference/rgcca.html">rgcca</a></span><span class="op">(</span>A<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">...</span>, <span class="va">XJ</span><span class="op">)</span>, 
                      C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">J</span>, <span class="va">J</span><span class="op">)</span>,
                       tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">J</span><span class="op">)</span>,
                       scheme <span class="op">=</span> <span class="st">"centroid"</span><span class="op">)</span></code></pre></div>
</div>
<div id="sumcov-2" class="section level3">
<h3 class="hasAnchor">
<a href="#sumcov-2" class="anchor"></a>SUMCOV-2</h3>
<p>SUMCOV-2 is obtained from following optimization problem</p>
<p><span class="math display">\[\begin{equation}
\underset{\ensuremath{\mathbf{a}}_1, \ensuremath{\mathbf{a}}_2, \ldots,\ensuremath{\mathbf{a}}_J} {\text{maximize}} \displaystyle \sum_{j, k = 1 ; j \ne k}^J  \text{cov}(\ensuremath{\mathbf{X}}_j\ensuremath{\mathbf{a}}_j, \ensuremath{\mathbf{X}}_k\ensuremath{\mathbf{a}}_k) \text{~~s.t~~} \Vert \ensuremath{\mathbf{a}}_j \Vert = 1, j=1, \ldots, J
\end{equation}\]</span></p>
<p>and is obtained with the <code><a href="../reference/rgcca.html">rgcca()</a></code> function as follows:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># X1 = Block1, ..., XJ = BlockJ</span>
<span class="co"># J*J Design matrix C</span>
<span class="va">C</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">J</span>, <span class="va">J</span><span class="op">)</span> ; <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">C</span><span class="op">)</span> <span class="op">=</span> <span class="fl">0</span>
<span class="co"># Shrinkage parameters tau = c(tau1, ...,  tauJ)</span>
<span class="va">maxbet.with.rgcca</span> <span class="op">=</span> <span class="fu"><a href="../reference/rgcca.html">rgcca</a></span><span class="op">(</span>A<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">...</span>, <span class="va">XJ</span><span class="op">)</span>, 
                       C <span class="op">=</span> <span class="va">C</span>,
                       tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">J</span><span class="op">)</span>,
                       scheme <span class="op">=</span> <span class="st">"horst"</span><span class="op">)</span></code></pre></div>
</div>
<div id="ssqcov-2" class="section level3">
<h3 class="hasAnchor">
<a href="#ssqcov-2" class="anchor"></a>SSQCOV-2</h3>
<p>SSQCOV-2 is obtained from following optimization problem</p>
<p><span class="math display">\[\begin{equation}
\underset{\ensuremath{\mathbf{a}}_1, \ensuremath{\mathbf{a}}_2, \ldots,\ensuremath{\mathbf{a}}_J} {\text{maximize}} \displaystyle \sum_{j, k = 1; j \ne k}^J \text{cov}^2(\ensuremath{\mathbf{X}}_j\ensuremath{\mathbf{a}}_j, \ensuremath{\mathbf{X}}_k\ensuremath{\mathbf{a}}_k) \text{~~s.t~~} \Vert \ensuremath{\mathbf{a}}_j \Vert = 1, j=1, \ldots, J
\end{equation}\]</span></p>
<p>and is obtained with the <code><a href="../reference/rgcca.html">rgcca()</a></code> function as follows:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># X1 = Block1, ..., XJ = BlockJ</span>
<span class="co"># J*J Design matrix C</span>
<span class="va">C</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">J</span>, <span class="va">J</span><span class="op">)</span> ; <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">C</span><span class="op">)</span> <span class="op">=</span> <span class="fl">0</span>
<span class="co"># Shrinkage parameters tau = c(tau1, ...,  tauJ)</span>
<span class="va">maxbetb.with.rgcca</span> <span class="op">=</span> <span class="fu"><a href="../reference/rgcca.html">rgcca</a></span><span class="op">(</span>A<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">...</span>, <span class="va">XJ</span><span class="op">)</span>, 
                       C <span class="op">=</span> <span class="va">C</span>,
                       tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">J</span><span class="op">)</span>,
                       scheme <span class="op">=</span> <span class="st">"factorial"</span><span class="op">)</span></code></pre></div>
</div>
<div id="generalized-cca-carroll1968a" class="section level3">
<h3 class="hasAnchor">
<a href="#generalized-cca-carroll1968a" class="anchor"></a>Generalized CCA <span class="citation">(J.D. Carroll 1968)</span>
</h3>
<p>For Carroll’s Generalized Canonical Correlation Analysis (GCCA), a superblock <span class="math inline">\(\ensuremath{\mathbf{X}}_{J+1} = \left[\ensuremath{\mathbf{X}}_1, \dots, \ensuremath{\mathbf{X}}_J \right]\)</span> defined as the concatenation of all the blocks is introduced. GCCA is defined as the following optimization problem</p>
<p><span class="math display">\[\begin{equation}
\underset{\ensuremath{\mathbf{a}}_1, \ensuremath{\mathbf{a}}_2, \ldots,\ensuremath{\mathbf{a}}_J} {\text{maximize}} \displaystyle \sum_{j=1}^J \text{cor}^2(\ensuremath{\mathbf{X}}_j\ensuremath{\mathbf{a}}_j, \ensuremath{\mathbf{X}}_{J+1}\ensuremath{\mathbf{a}}_{J+1}) \text{~~s.t~~} \text{var}(\mathbf{X}_j \ensuremath{\mathbf{a}}_j) = 1, j=1, \ldots, J+1
\end{equation}\]</span></p>
<p>and is obtained with the <code><a href="../reference/rgcca.html">rgcca()</a></code> function as follows:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># X1 = Block1, ..., XJ = BlockJ, X_{J+1} = [X1, ..., XJ]</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co"># (J+1)*(J+1) Design matrix C</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>C =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, ..., <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb14-4"><a href="#cb14-4"></a>             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, ..., <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb14-5"><a href="#cb14-5"></a>             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, ..., <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb14-6"><a href="#cb14-6"></a>                  ...</span>
<span id="cb14-7"><a href="#cb14-7"></a>             <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, ..., <span class="dv">1</span>, <span class="dv">0</span>), J<span class="op">+</span><span class="dv">1</span>, J<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="co"># Shrinkage parameters tau = c(tau1, ...,  tauJ, tau_{J+1})</span></span>
<span id="cb14-9"><a href="#cb14-9"></a>gcca.with.rgcca =<span class="st"> </span><span class="kw">rgcca</span>(<span class="dt">A=</span> <span class="kw">list</span>(X1, ..., XJ, <span class="kw">cbind</span>(X1, ..., XJ)), </span>
<span id="cb14-10"><a href="#cb14-10"></a>                       <span class="dt">C =</span> C,</span>
<span id="cb14-11"><a href="#cb14-11"></a>                       <span class="dt">tau =</span> <span class="kw">rep</span>(<span class="dv">0</span>, J<span class="op">+</span><span class="dv">1</span>),</span>
<span id="cb14-12"><a href="#cb14-12"></a>                       <span class="dt">scheme =</span> <span class="st">"factorial"</span>)</span></code></pre></div>
</div>
<div id="multiple-co-inertia-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#multiple-co-inertia-analysis" class="anchor"></a>Multiple Co-Inertia Analysis</h3>
<p>For Multiple Co-Inertia Analysis (MCOA) a superblock <span class="math inline">\(\ensuremath{\mathbf{X}}_{J+1} = [\ensuremath{\mathbf{X}}_1, \dots, \ensuremath{\mathbf{X}}_J\)</span> defined as the concatenation of all the blocks is introduced. MCOA is defined as the following optimization problem</p>
<p><span class="math display">\[\begin{equation}
\underset{\ensuremath{\mathbf{a}}_1, \ensuremath{\mathbf{a}}_2, \ldots,\ensuremath{\mathbf{a}}_J} {\text{maximize}} \displaystyle \sum_{j=1}^J \text{cor}^2(\ensuremath{\mathbf{X}}_j\ensuremath{\mathbf{a}}_j, \ensuremath{\mathbf{X}}_{J+1}\ensuremath{\mathbf{a}}_{J+1})\times \text{var}(\mathbf{X}_j\ensuremath{\mathbf{a}}_j), \text{~~s.t~~} \Vert \ensuremath{\mathbf{a}}_j \Vert = 1, j=1, \ldots, J \text{~~and~~} \text{var}(\mathbf{X}_{J+1}\ensuremath{\mathbf{a}}_{J+1}) = 1
\end{equation}\]</span></p>
<p>and is obtained with the <code><a href="../reference/rgcca.html">rgcca()</a></code> function as follows:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># X1 = Block1, ..., XJ = BlockJ, X_{J+1} = [X1, ..., XJ]</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="co"># (J+1)*(J+1) Design matrix C</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>C =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, ..., <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb15-4"><a href="#cb15-4"></a>             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, ..., <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb15-5"><a href="#cb15-5"></a>             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, ..., <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb15-6"><a href="#cb15-6"></a>                   ...</span>
<span id="cb15-7"><a href="#cb15-7"></a>             <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, ..., <span class="dv">1</span>, <span class="dv">0</span>), J<span class="op">+</span><span class="dv">1</span>, J<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="co"># Shrinkage parameters tau = c(tau1, ...,  tauJ, tau_{J+1})</span></span>
<span id="cb15-9"><a href="#cb15-9"></a>mcoa.with.rgcca =<span class="st"> </span><span class="kw">rgcca</span>(<span class="dt">A=</span> <span class="kw">list</span>(X1, ..., XJ, <span class="kw">cbind</span>(X1, ..., XJ)), </span>
<span id="cb15-10"><a href="#cb15-10"></a>                       <span class="dt">C =</span> C,</span>
<span id="cb15-11"><a href="#cb15-11"></a>                       <span class="dt">tau =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, J), <span class="dv">0</span>),</span>
<span id="cb15-12"><a href="#cb15-12"></a>                       <span class="dt">scheme =</span> <span class="st">"factorial"</span>)</span></code></pre></div>
</div>
<div id="hierarchical-principal-component-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#hierarchical-principal-component-analysis" class="anchor"></a>Hierarchical Principal Component Analysis</h3>
<p>For Hierarchical Principal Component Analysis (HPCA), a superblock <span class="math inline">\(\ensuremath{\mathbf{X}}_{J+1} = [\ensuremath{\mathbf{X}}_1, \dots, \ensuremath{\mathbf{X}}_J]\)</span> defined as the concatenation of all the blocks is introduced. HPCA is defined as the following optimization problem</p>
<p><span class="math display">\[\begin{equation}
\underset{\ensuremath{\mathbf{a}}_1, \ensuremath{\mathbf{a}}_2, \ldots,\ensuremath{\mathbf{a}}_J} {\text{maximize}} \displaystyle \sum_{j=1}^J \text{cov}^4(\ensuremath{\mathbf{X}}_j\ensuremath{\mathbf{a}}_j, \ensuremath{\mathbf{X}}_{J+1}\ensuremath{\mathbf{a}}_{J+1}), \text{~~s.t~~} \Vert \ensuremath{\mathbf{a}}_j \Vert = 1, j=1, \ldots, J \text{~~and~~} \text{var}(\mathbf{X}_{J+1}\ensuremath{\mathbf{a}}_{J+1}) = 1
\end{equation}\]</span></p>
<p>and is obtained with the <code><a href="../reference/rgcca.html">rgcca()</a></code> function as follows:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># X1 = Block1, ..., XJ = BlockJ, X_{J+1} = [X1, ..., XJ]</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="co"># (J+1)*(J+1) Design matrix C</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>C =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, ..., <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb16-4"><a href="#cb16-4"></a>             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, ..., <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb16-5"><a href="#cb16-5"></a>             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, ..., <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb16-6"><a href="#cb16-6"></a>                  ...</span>
<span id="cb16-7"><a href="#cb16-7"></a>             <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, ..., <span class="dv">1</span>, <span class="dv">0</span>), J<span class="op">+</span><span class="dv">1</span>, J<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="co"># Shrinkage parameters tau = c(tau1, ...,  tauJ, tau_{J+1})</span></span>
<span id="cb16-9"><a href="#cb16-9"></a>hpca.with.rgcca =<span class="st"> </span><span class="kw">rgcca</span>(<span class="dt">A=</span> <span class="kw">list</span>(X1, ..., XJ, <span class="kw">cbind</span>(X1, ..., XJ)), </span>
<span id="cb16-10"><a href="#cb16-10"></a>                       <span class="dt">C =</span> C,</span>
<span id="cb16-11"><a href="#cb16-11"></a>                       <span class="dt">tau =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, J), <span class="dv">0</span>),</span>
<span id="cb16-12"><a href="#cb16-12"></a>                       <span class="co">#flexible design of the scheme function</span></span>
<span id="cb16-13"><a href="#cb16-13"></a>                       <span class="dt">scheme =</span> <span class="cf">function</span>(x) x<span class="op">^</span><span class="dv">4</span>) </span></code></pre></div>
</div>
<div id="principal-component-analysis-alternative-formulation" class="section level3">
<h3 class="hasAnchor">
<a href="#principal-component-analysis-alternative-formulation" class="anchor"></a>Principal Component Analysis (alternative formulation)</h3>
<p>Let <span class="math inline">\(\ensuremath{\mathbf{X}} =[\ensuremath{\mathbf{x}}_1, \ldots, \ensuremath{\mathbf{x}}_p]\)</span> be a <span class="math inline">\(n \times p\)</span> data matrix. PCA can be defined as the following optimization problem</p>
<p><span class="math display">\[\begin{equation}
\underset{\ensuremath{\mathbf{a}}}{\text{maximize}} \displaystyle \sum_{j=1}^p \text{cor}^2(\ensuremath{\mathbf{x}}_{j}, \ensuremath{\mathbf{X}} \ensuremath{\mathbf{a}}) \text{~~s.t~~} \text{var}(\ensuremath{\mathbf{X}} \ensuremath{\mathbf{a}})=1
\end{equation}\]</span></p>
<p>and is obtained with the <code><a href="../reference/rgcca.html">rgcca()</a></code> function as follows:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># one block X = [x1, ..., xJ] with J variables x1, ..., xJ</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="co"># (J+1)*(J+1) Design matrix C</span></span>
<span id="cb17-3"><a href="#cb17-3"></a>C =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, ..., <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb17-4"><a href="#cb17-4"></a>             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, ..., <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb17-5"><a href="#cb17-5"></a>             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, ..., <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb17-6"><a href="#cb17-6"></a>                  ...</span>
<span id="cb17-7"><a href="#cb17-7"></a>             <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, ..., <span class="dv">1</span>, <span class="dv">0</span>), J<span class="op">+</span><span class="dv">1</span>, J<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="co"># Shrinkage parameters tau = c(tau1, ...,  tauJ, tau_{J+1})</span></span>
<span id="cb17-9"><a href="#cb17-9"></a>pca.with.rgcca =<span class="st"> </span><span class="kw">rgcca</span>(<span class="kw">list</span>(x1, ..., xJ, X), </span>
<span id="cb17-10"><a href="#cb17-10"></a>                       <span class="dt">C =</span> C,</span>
<span id="cb17-11"><a href="#cb17-11"></a>                       <span class="dt">tau =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, J<span class="op">+</span><span class="dv">1</span>), <span class="dv">0</span>),</span>
<span id="cb17-12"><a href="#cb17-12"></a>                       <span class="co">#flexible design of the scheme function</span></span>
<span id="cb17-13"><a href="#cb17-13"></a>                       <span class="dt">scheme =</span> <span class="cf">function</span>(x) x<span class="op">^</span><span class="dv">2</span>) </span></code></pre></div>
</div>
</div>
</div>
<div id="practical-session" class="section level1">
<h1 class="hasAnchor">
<a href="#practical-session" class="anchor"></a>Practical session</h1>
<div id="rgcca-for-the-russett-dataset-" class="section level2">
<h2 class="hasAnchor">
<a href="#rgcca-for-the-russett-dataset-" class="anchor"></a>RGCCA for the Russett dataset.</h2>
<p>In this section, we propose to reproduce some of the results presented in <span class="citation">(Tenenhaus and Tenenhaus 2011)</span> for the Russett data. The Russett dataset is available within the RGCCA package. The Russett data set <span class="citation">(Russett 1964)</span> are studied in <span class="citation">(Gifi 1990)</span>. Russett collected this data to study relationships between Agricultural Inequality, Industrial Development and Political Instability.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/llrs/RGCCA">RGCCA</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">Russett</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">Russett</span><span class="op">)</span></code></pre></div>
<pre><code>##           gini farm rent gnpr labo inst ecks death demostab demoinst dictator
## Argentina 86.3 98.2 3.52 5.92 3.22 0.07 4.06  5.38        0        1        0
## Australia 92.9 99.6 3.27 7.10 2.64 0.01 0.00  0.00        1        0        0
## Austria   74.0 97.4 2.46 6.28 3.47 0.03 1.61  0.00        0        1        0
## Belgium   58.7 85.8 4.15 6.92 2.30 0.45 2.20  0.69        1        0        0
## Bolivia   93.8 97.7 3.04 4.19 4.28 0.37 3.99  6.50        0        0        1
## Brasil    83.7 98.5 2.31 5.57 4.11 0.45 3.91  0.69        0        1        0</code></pre>
<p>The first step of the analysis is to define the blocks. Three blocks of variables have been defined for 47 countries. The variables that compose each block have been defined according to the nature of the variables.</p>
<ul>
<li>The first block <span class="math inline">\(\mathbf{X}_1\)</span> = [GINI, FARM, RENT] is related to “Agricultural Inequality”:
<ul>
<li>GINI = Inequality of land distribution,</li>
<li>FARM = % farmers that own half of the land (&gt; 50),</li>
<li>RENT = % farmers that rent all their land.</li>
</ul>
</li>
<li>The second block <span class="math inline">\(\mathbf{X}_2\)</span> = [GNPR, LABO] describes “Industrial Development”:
<ul>
<li>GNPR = Gross national product per capita ($1955),</li>
<li>LABO = % of labor force employed in agriculture.</li>
</ul>
</li>
<li>The third one <span class="math inline">\(\mathbf{X}_3\)</span> = [INST, ECKS, DEAT] measures “Political Instability”:
<ul>
<li>INST = Instability of executive (45-61),</li>
<li>ECKS = Number of violent internal war incidents (46-61),</li>
<li>DEAT = Number of people killed as a result of civic group violence (50-62).</li>
<li>An additional variable DEMO describes the political regime: stable democracy, unstable democracy or dictatorship. The dummy variable “unstable democracy” has been left out because of redundancy.</li>
</ul>
</li>
</ul>
<p>The different blocks of variables <span class="math inline">\(\ensuremath{\mathbf{X}}_1, \ldots, \ensuremath{\mathbf{X}}_J\)</span> are arranged in the list format.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X_agric</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">Russett</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gini"</span>,<span class="st">"farm"</span>,<span class="st">"rent"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">X_ind</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">Russett</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gnpr"</span>,<span class="st">"labo"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">X_polit</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">Russett</span><span class="op">[</span> , <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"inst"</span>, <span class="st">"ecks"</span>,  <span class="st">"death"</span>,
                                 <span class="st">"demostab"</span>, <span class="st">"dictator"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">A</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">X_agric</span>, <span class="va">X_ind</span>, <span class="va">X_polit</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">head</span><span class="op">)</span></code></pre></div>
<pre><code>## [[1]]
##           gini farm rent
## Argentina 86.3 98.2 3.52
## Australia 92.9 99.6 3.27
## Austria   74.0 97.4 2.46
## Belgium   58.7 85.8 4.15
## Bolivia   93.8 97.7 3.04
## Brasil    83.7 98.5 2.31
## 
## [[2]]
##           gnpr labo
## Argentina 5.92 3.22
## Australia 7.10 2.64
## Austria   6.28 3.47
## Belgium   6.92 2.30
## Bolivia   4.19 4.28
## Brasil    5.57 4.11
## 
## [[3]]
##           inst ecks death demostab dictator
## Argentina 0.07 4.06  5.38        0        0
## Australia 0.01 0.00  0.00        1        0
## Austria   0.03 1.61  0.00        0        0
## Belgium   0.45 2.20  0.69        1        0
## Bolivia   0.37 3.99  6.50        0        1
## Brasil    0.45 3.91  0.69        0        0</code></pre>
<p><strong>Preprocessing</strong> In order to ensure comparability between variables standardization is applied (zero mean and unit variance).</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">A</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/scale2.html">scale2</a></span><span class="op">(</span><span class="va">x</span>, bias <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>We note that to make blocks comparable, a possible strategy is to standardize the variables and then to divide each block by the square root of its number of variables <span class="citation">(Westerhuis, Kourti, and MacGregor 1998)</span>. This two-step procedure leads to <span class="math inline">\(\mathrm{tr}(\ensuremath{\mathbf{X}}_j^t \ensuremath{\mathbf{X}}_j )=n\)</span> for each block (i.e. the sum of the eigenvalues of the covariance matrix of <span class="math inline">\(\ensuremath{\mathbf{X}}_j\)</span> is equal to <span class="math inline">\(1\)</span> whatever the block). Such a preprocessing is reached by setting the <code>scale</code> argument to <code>TRUE</code> (default value) in the <code><a href="../reference/rgcca.html">rgcca()</a></code> and <code><a href="../reference/sgcca.html">sgcca()</a></code> functions.</p>
<p><strong>Definition of the design matrix <span class="math inline">\(\mathbf{C}\)</span>.</strong> From Russett’s hypotheses, it is difficult for a country to escape dictatorship when its agricultural inequality is above-average and its industrial development below-average. These hypotheses on the relationships between blocks are depicted in Figure .</p>

<p>and encoded through the design matrix <span class="math inline">\(\mathbf{C}\)</span>; usually <span class="math inline">\(c_{jk} = 1\)</span> for two connected blocks and <span class="math inline">\(0\)</span> otherwise. Therefore, we have decided to connect Agricultural Inequality to Political Instability (<span class="math inline">\(c_{13} = 1\)</span>), Industrial Development to Political Instability (<span class="math inline">\(c_{23} = 1\)</span>) and to not connect Agricultural Inequality to Industrial Development (<span class="math inline">\(c_{12} = 0\)</span>). The resulting design matrix <span class="math inline">\(\ensuremath{\mathbf{C}}\)</span> is:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Define the design matrix C.</span>
<span class="va">C</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>,
<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>,
<span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>

<span class="va">C</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    0    0    1
## [2,]    0    0    1
## [3,]    1    1    0</code></pre>
<p>RGCCA using the pre-defined design matrix <span class="math inline">\(\ensuremath{\mathbf{C}}\)</span>, the factorial scheme (<span class="math inline">\(g(x) = x^2\)</span>) and mode B for all blocks (full correlation criterion) is obtained by specifying appropriately the <code>C</code>, <code>scheme</code> and <code>tau</code> arguments of the <code><a href="../reference/rgcca.html">rgcca()</a></code> function. The <code>verbose</code> argument (default value = <code>TRUE</code>) indicates that the progress will be reported while computing and that a plot representing the convergence of the algorithm will be returned.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rgcca_B_factorial</span> <span class="op">=</span> <span class="fu"><a href="../reference/rgcca.html">rgcca</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">C</span>, tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>, scheme <span class="op">=</span> <span class="st">"factorial"</span>,
scale <span class="op">=</span> <span class="cn">FALSE</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Computation of the RGCCA block components based on the factorial scheme</code></pre>
<pre><code>## Shrinkage intensity paramaters are chosen manually</code></pre>
<pre><code>##  Iter:   1 Fit: 1.83005079 Dif: 0.38803933</code></pre>
<pre><code>##  Iter:   2 Fit: 1.92003517 Dif: 0.08998438</code></pre>
<pre><code>##  Iter:   3 Fit: 1.93192442 Dif: 0.01188925</code></pre>
<pre><code>##  Iter:   4 Fit: 1.93354278 Dif: 0.00161836</code></pre>
<pre><code>##  Iter:   5 Fit: 1.93376871 Dif: 0.00022593</code></pre>
<pre><code>##  Iter:   6 Fit: 1.93380060 Dif: 0.00003189</code></pre>
<pre><code>##  Iter:   7 Fit: 1.93380512 Dif: 0.00000452</code></pre>
<pre><code>##  Iter:   8 Fit: 1.93380576 Dif: 0.00000064</code></pre>
<pre><code>##  Iter:   9 Fit: 1.93380585 Dif: 0.00000009</code></pre>
<pre><code>##  Iter:  10 Fit: 1.93380586 Dif: 0.00000001</code></pre>
<pre><code>##  Iter:  11 Fit: 1.93380586 Dif: 0.00000000</code></pre>
<pre><code>## The RGCCA algorithm converged to a stationary point after 10 iterations</code></pre>
<p><img src="vignette_RGCCA_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<p>The weight vectors, solution of the optimization problem () are obtained as:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rgcca_B_factorial</span><span class="op">$</span><span class="va">a</span> <span class="co"># weight vectors</span></code></pre></div>
<pre><code>## [[1]]
##            [,1]
## gini  1.0547022
## farm -2.0219012
## rent  0.7862647
## 
## [[2]]
##            [,1]
## gnpr  0.3222996
## labo -0.7197074
## 
## [[3]]
##                 [,1]
## inst     -0.13546276
## ecks      0.12781973
## death    -0.08400384
## demostab -0.83515000
## dictator  0.24426988</code></pre>
<p>and correspond exactly to the weight vectors reported in <span class="citation">(Tenenhaus and Tenenhaus 2011, see Figure 4)</span>. The block-components are also avalaible as output of <code>rgcca</code>. The first components of each block are given by:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Y</span> <span class="op">=</span> <span class="va">rgcca_B_factorial</span><span class="op">$</span><span class="va">Y</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">head</span><span class="op">)</span></code></pre></div>
<pre><code>## [[1]]
##                 comp1
## Argentina  0.12892660
## Australia -0.01639636
## Austria   -1.41575574
## Belgium    2.38653543
## Bolivia    0.43847422
## Brasil    -1.15744593
## 
## [[2]]
##                comp1
## Argentina  0.3340091
## Australia  1.3652526
## Austria    0.2065837
## Belgium    1.6515657
## Bolivia   -1.3949715
## Brasil    -0.7152149
## 
## [[3]]
##                comp1
## Argentina  0.4534912
## Australia -1.4930824
## Austria    0.4399732
## Belgium   -1.5556128
## Bolivia    0.7323576
## Brasil     0.3981005</code></pre>
<p>Moreover, using the idea of Average Variance Explained (AVE), the following indicators of model quality are proposed:</p>
<ul>
<li>The AVE of block <span class="math inline">\(\ensuremath{\mathbf{X}}_j\)</span>, denoted by AVE(<span class="math inline">\(\ensuremath{\mathbf{X}}_j\)</span>), is defined as:</li>
</ul>
<p><span class="math display">\[\begin{equation}
\mathrm{AVE}(\ensuremath{\mathbf{X}}_j)=  1/p_j \sum_{h=1}^{p_j} cor^2( \ensuremath{\mathbf{x}}_{jh},\ensuremath{\mathbf{y}}_j)
\end{equation}\]</span></p>
<p>AVE(<span class="math inline">\(\ensuremath{\mathbf{X}}_j\)</span>) varies between 0 and 1 and reflects the proportion of variance captured by <span class="math inline">\(\ensuremath{\mathbf{y}}_j\)</span>.</p>
<ul>
<li>For all blocks:</li>
</ul>
<p><span class="math display">\[\begin{equation}
\displaystyle \mathrm{AVE(outer model)} = \left( 1/\sum_j p_j \right) \sum_j p_j \mathrm{AVE}(\ensuremath{\mathbf{X}}_j)
\end{equation}\]</span></p>
<ul>
<li>For the inner model:</li>
</ul>
<p><span class="math display">\[\begin{equation}
\displaystyle \mathrm{AVE(inner model)} = \left( 1/\sum_{j&lt;k} c_{jk} \right) \sum_{j&lt;k} c_{jk} \mathrm{cor}^2(\ensuremath{\mathbf{y}}_j , \ensuremath{\mathbf{y}}_k)
\end{equation}\]</span></p>
<p>These indicators of model quality can be obtained as follows:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rgcca_B_factorial</span><span class="op">$</span><span class="va">AVE</span></code></pre></div>
<pre><code>## $AVE_X
## $AVE_X[[1]]
## [1] 0.2696404
## 
## $AVE_X[[2]]
## [1] 0.8956496
## 
## $AVE_X[[3]]
## [1] 0.4387091
## 
## 
## $AVE_outer
## [1] 0.4793766
## 
## $AVE_inner
## [1] 0.4834515</code></pre>
<p>and corresponds exactly to the results reported in <span class="citation">(Tenenhaus and Tenenhaus 2011, see last column of Table 7)</span>.</p>
<p>We mention that, for each block <span class="math inline">\(j\)</span>, an “optimal” shrinkage parameter <span class="math inline">\(\tau_j\)</span> can be obtained from the Schafer and Strimmer analytical formula <span class="citation">(Schäfer and Strimmer 2005)</span> by using the <code>tau</code> argument of the rgcca funtion:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rgcca_optimal_factorial</span> <span class="op">=</span> <span class="fu"><a href="../reference/rgcca.html">rgcca</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">C</span>, tau <span class="op">=</span> <span class="st">"optimal"</span>, scheme <span class="op">=</span> <span class="st">"factorial"</span>,
scale <span class="op">=</span> <span class="cn">FALSE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>The optimal shrinkage parameters are given by:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rgcca_optimal_factorial</span><span class="op">$</span><span class="va">tau</span></code></pre></div>
<pre><code>## [1] 0.08853216 0.02703256 0.08422566</code></pre>
<p>This automatic estimation of the shrinkage parameters allows one to come closer to the correlation criterion, even in the case of high multicollinearity or when the number of individuals is smaller than the number of variables.</p>
<p>At last, as a component-based method, RGCCA provides the users with graphical representations, including factor plot, correlation circle. This graphical displays allows visualizing the sources of variability within blocks, the relationships between variables within and between blocks and the amount of correlation between blocks. The graphical display of the countries obtained by crossing <span class="math inline">\(\ensuremath{\mathbf{X}}_1 \ensuremath{\mathbf{a}}_1\)</span> = Agricultural Inequality and <span class="math inline">\(\ensuremath{\mathbf{X}}_2 \ensuremath{\mathbf{a}}_2\)</span> = Industrial Development and marked with their political regime in 1960 is shown in below.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>political_regime <span class="op">=</span>
<span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">Russett</span><span class="op">[</span>, <span class="fl">9</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">which.max</span><span class="op">)</span>,
labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"demostab"</span>, <span class="st">"demoinst"</span>, <span class="st">"dictator"</span><span class="op">)</span><span class="op">)</span>,
comp1 <span class="op">=</span> <span class="va">rgcca_B_factorial</span><span class="op">$</span><span class="va">Y</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>,
comp2 <span class="op">=</span> <span class="va">rgcca_B_factorial</span><span class="op">$</span><span class="va">Y</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">comp1</span>, <span class="va">comp2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
<span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
<span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
<span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Factor plot (Russett data)"</span><span class="op">)</span> <span class="op">+</span>
<span class="fu">geom_text</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>colour <span class="op">=</span> <span class="va">political_regime</span>, label<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>,
vjust<span class="op">=</span><span class="fl">0</span>,nudge_y <span class="op">=</span> <span class="fl">0.03</span>,size <span class="op">=</span> <span class="fl">3</span> <span class="op">)</span><span class="op">+</span>
<span class="fu">theme</span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"bottom"</span>, legend.box <span class="op">=</span> <span class="st">"horizontal"</span>,
legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="va">p</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="vignette_RGCCA_files/figure-html/unnamed-chunk-29-1.png" alt="graphical display of the countries obtained by crossing y1 and y2 and labeled according to their political regime" width="700"><p class="caption">
graphical display of the countries obtained by crossing y1 and y2 and labeled according to their political regime
</p>
</div>
<p>Countries aggregate together when they share similarities. It may be noted that the lower left quadrant concentrates on dictatorships. It is difficult for a country to escape dictatorship when its industrial development is below-average and its agricultural inequality is above average. It is worth pointing out that some unstable democracies located in this quadrant (or close to it) became dictatorships for a period of time after 1960: Greece (1967-1974), Brazil (1964-1985), Chili (1973-1990), and Argentina (1966-1973).</p>
<p>Moreover, in the framework of consensus PCA and Hierarchical PCA, a superblock defined as the concatenation of all the blocks is also used and global components can be derived. The space spanned by the global components is viewed as a compromise space that integrated all the modalities and facilitates the visualization of the results and their interpretation.</p>
<p>Here, <span class="math inline">\(2\)</span> components per block are specified using the <code>ncomp = rep(2, 4)</code> argument (default value <code>ncomp = rep(1, length(A))</code>, which gives one component per block).</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X_agric</span> <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">Russett</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gini"</span>,<span class="st">"farm"</span>,<span class="st">"rent"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">X_ind</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">Russett</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gnpr"</span>,<span class="st">"labo"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">X_polit</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">Russett</span><span class="op">[</span> , <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"inst"</span>, <span class="st">"ecks"</span>,  <span class="st">"death"</span>,
<span class="st">"demostab"</span>, <span class="st">"demoinst"</span>, <span class="st">"dictator"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">A</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>X_agric <span class="op">=</span> <span class="va">X_agric</span>, X_ind <span class="op">=</span> <span class="va">X_ind</span>, X_polit <span class="op">=</span> <span class="va">X_polit</span>,
Superblock <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">X_agric</span>, <span class="va">X_ind</span>, <span class="va">X_polit</span><span class="op">)</span>
<span class="op">)</span>
<span class="co">#Define the design matrix (output = C)</span>
<span class="va">C</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>,
<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>,
<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>,
<span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>

<span class="va">rgcca.hpca</span> <span class="op">=</span> <span class="fu"><a href="../reference/rgcca.html">rgcca</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">C</span>, tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>,
ncomp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>,
<span class="co">#flexible design of the scheme function</span>
scheme <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">^</span><span class="fl">4</span>,
scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>For HPCA, the countries can be represented in the space spanned by the two first global components.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>political_regime <span class="op">=</span>
<span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">Russett</span><span class="op">[</span>, <span class="fl">9</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">which.max</span><span class="op">)</span>,
labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"demostab"</span>, <span class="st">"demoinst"</span>, <span class="st">"dictator"</span><span class="op">)</span><span class="op">)</span>,
<span class="va">rgcca.hpca</span><span class="op">$</span><span class="va">Y</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>
<span class="op">)</span>

<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df1</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">comp1</span>, <span class="va">comp2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
<span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
<span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
<span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Factor plot (Russett data) - Common Space"</span><span class="op">)</span> <span class="op">+</span>
<span class="fu">geom_text</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>colour <span class="op">=</span> <span class="va">political_regime</span>, label<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">df1</span><span class="op">)</span><span class="op">)</span>,
vjust<span class="op">=</span><span class="fl">0</span>,nudge_y <span class="op">=</span> <span class="fl">0.03</span>,size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">+</span>
<span class="fu">theme</span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"bottom"</span>, legend.box <span class="op">=</span> <span class="st">"horizontal"</span>,
legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="va">p1</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="vignette_RGCCA_files/figure-html/unnamed-chunk-31-1.png" alt="graphical display of the countries obtained by crossing the two first compoent of the superblock and labeled according to their political regime" width="700"><p class="caption">
graphical display of the countries obtained by crossing the two first compoent of the superblock and labeled according to their political regime
</p>
</div>
<p>Despite some overlap, the first global component exhibits a separation/continuum among regimes.</p>
<p>Moreover, the correlation circle plot highlights the contribution of each variable to the contruction of the global components. This figure shows the original variables projected on the compromise space.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>comp1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">Russett</span>, <span class="va">rgcca.hpca</span><span class="op">$</span><span class="va">Y</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>,
comp2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">Russett</span>, <span class="va">rgcca.hpca</span><span class="op">$</span><span class="va">Y</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>,
BLOCK <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"X3"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">A</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="va">NCOL</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Circle</span>
<span class="va">circleFun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">center</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,<span class="va">diameter</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">npoints</span> <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">{</span>
<span class="va">r</span> <span class="op">=</span> <span class="va">diameter</span> <span class="op">/</span> <span class="fl">2</span>
<span class="va">tt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">*</span><span class="va">pi</span>,length.out <span class="op">=</span> <span class="va">npoints</span><span class="op">)</span>
<span class="va">xx</span> <span class="op">&lt;-</span> <span class="va">center</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">r</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">tt</span><span class="op">)</span>
<span class="va">yy</span> <span class="op">&lt;-</span> <span class="va">center</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">r</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">tt</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">xx</span>, y <span class="op">=</span> <span class="va">yy</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">circle</span> <span class="op">&lt;-</span> <span class="fu">circleFun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fl">2</span>,npoints <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df2</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">comp1</span>, <span class="va">comp2</span><span class="op">)</span>, colour <span class="op">=</span> <span class="va">BLOCK</span><span class="op">)</span> <span class="op">+</span>
<span class="fu">geom_path</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span>, data<span class="op">=</span><span class="va">circle</span><span class="op">)</span> <span class="op">+</span>
<span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
<span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
<span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Correlation Circle (Russett data) - Common Space"</span><span class="op">)</span> <span class="op">+</span>
<span class="fu">geom_text</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>colour <span class="op">=</span> <span class="va">BLOCK</span>, label<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span><span class="op">)</span>,
vjust<span class="op">=</span><span class="fl">0</span>,nudge_y <span class="op">=</span> <span class="fl">0.03</span>,size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">+</span>
<span class="fu">theme</span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"bottom"</span>, legend.box <span class="op">=</span> <span class="st">"horizontal"</span>,
legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="va">p2</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="vignette_RGCCA_files/figure-html/TRUE-1.png" alt="correlation circle plot - two first components of the superblock. Variables are colored according to their block membership" width="700"><p class="caption">
correlation circle plot - two first components of the superblock. Variables are colored according to their block membership
</p>
</div>
<p>A variable that is highly expressed for a category of individuals is projected with a high weight (far from the origin) in the direction of that category.</p>
<p><strong>Assessment of the reliability of parameter estimates.</strong> It is possible to use a bootstrap resampling method to assess the reliability of parameter estimates obtained using RGCCA. B bootstrap samples of the same size as the original data is repeatedly sampled with replacement from the original data. RGCCA is then applied to each bootstrap sample to obtain the R/SGCCA estimates. For RGCCA, we calculate the mean and variance of the estimates across the bootstrap samples, from which we derived, bootstrap confidence intervals, t-ratio and p-value (under the assumption that the parameter estimates exhibited asymptotic normality) to indicate how reliably parameters were estimated. Since several p-values are constructed simultaneously, Bonferroni or FDR corrections can be applied for controlling the Family-Wise Error Rate or the False Discovery Rate, respectively. This function is not yet available in the current version of the RGCCA package and is available upon request.</p>
</div>
<div id="rgcca-dual-formulation-for-the-glioma-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#rgcca-dual-formulation-for-the-glioma-dataset" class="anchor"></a>RGCCA (dual formulation) for the Glioma dataset</h2>
<p><strong>Biological problem.</strong> Brain tumors are the most common solid tumors in children and have the highest mortality rate of all pediatric cancers. Despite advances in multimodality therapy, children with pHGG invariably have an overall survival of around 20% at 5 years. Depending on their location (e.g. brainstem, central nuclei, or supratentorial), pHGG present different characteristics in terms of radiological appearance, histology, and prognosis. Our hypothesis is that pHGG have different genetic origins and oncogenic pathways depending on their location. Thus, the biological processes involved in the development of the tumor may be different from one location to another, as it has been frequently suggested.</p>
<p><strong>Description of the data.</strong> Pretreatment frozen tumor samples were obtained from 53 children with newly diagnosed pHGG from Necker Enfants Malades (Paris, France) <span class="citation">(Puget et al. 2012)</span>. The 53 tumors are divided into 3 locations: supratentorial (HEMI), central nuclei (MIDL), and brain stem (DIPG). The final dataset is organized in 3 blocks of variables defined for the 53 tumors: the first block <span class="math inline">\(\ensuremath{\mathbf{X}}_1\)</span> provides the expression of <span class="math inline">\(15702\)</span> genes (GE). The second block <span class="math inline">\(\ensuremath{\mathbf{X}}_2\)</span> contains the imbalances of <span class="math inline">\(1229\)</span> segments (CGH) of chromosomes. <span class="math inline">\(\ensuremath{\mathbf{X}}_3\)</span> is a block of dummy variables describing the categorical variable location. One dummy variable has been left out because of redundancy with he others.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Download the dataset's package at http://biodev.cea.fr/sgcca/.</span>
<span class="co"># --&gt; gliomaData_0.4.tar.gz</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">ge_cgh_locIGR</span>, package <span class="op">=</span> <span class="st">"gliomaData"</span><span class="op">)</span>

<span class="va">A</span> <span class="op">&lt;-</span> <span class="va">ge_cgh_locIGR</span><span class="op">$</span><span class="va">multiblocks</span>
<span class="va">Loc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">ge_cgh_locIGR</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">Loc</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">ge_cgh_locIGR</span><span class="op">$</span><span class="va">multiblocks</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>
<span class="va">A</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="va">A</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="op">-</span><span class="fl">3</span><span class="op">]</span>

<span class="co"># check dimensions of the blocks</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">dim</span><span class="op">)</span></code></pre></div>
<pre><code>##         GE  CGH  y
## [1,]    53   53 53
## [2,] 15702 1229  2</code></pre>
<p><strong>Preprocessing</strong> To make variables comparable, standardization is applied (zero mean and unit variance). To make blocks comparable, we divide each block by the square root of its number of variables <span class="citation">(Westerhuis, Kourti, and MacGregor 1998)</span>. Such a preprocessing is set by default (<code>scale = TRUE</code>) when using <code>rgcca</code> or <code>sgcca</code> and is applied here.</p>
<p><strong>Path diagram.</strong> We propose to use the design matrix <span class="math inline">\(\ensuremath{\mathbf{C}}\)</span> represented in Figure .</p>

<p>This design is commonly used in many applications and is oriented toward the prediction of the location. This design does not impose any correlation between GE and CGH blocks and is encoded as follows:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">C</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>
<span class="va">C</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    0    0    1
## [2,]    0    0    1
## [3,]    1    1    0</code></pre>
<p><strong>Determination of the shrinkage parameters.</strong> In this situation, the optimal shrinkage parameters should be chosen so as to minimize the test error rate determined by cross-validation (grid search). This has been done in <span class="citation">(Arthur Tenenhaus, Philippe, and Frouin 2015)</span>. A function that implements this cross validation procedure is not yet included in the RGCCA package but can be found in <a href="http://biodev.cea.fr/sgcca/" class="uri">http://biodev.cea.fr/sgcca/</a>. Work is in progress to include this function within the RGCCA package. Due to the dimensionality of each block, the shrinkage parameters <span class="math inline">\(\tau_1 = 1\)</span>, <span class="math inline">\(\tau_2 = 1\)</span> and <span class="math inline">\(\tau_3 = 0\)</span> are found to offer a good compromise between stability and correlation <span class="citation">(Arthur Tenenhaus, Philippe, and Frouin 2015)</span>. Notice that <span class="math inline">\(\tau_3\)</span> was set to 0 because we were not looking for a block component <span class="math inline">\(\ensuremath{\mathbf{y}}_3\)</span> that explained its own block well (since <span class="math inline">\(\ensuremath{\mathbf{X}}_3\)</span> is a group coding matrix) but one that correlated with its neighboring components. In addition, usin the <code>ncomp</code> argument, one component per block have been asked (<code>ncomp = c(1, 1, 1)</code>).</p>
<p>From the dimension of each block (<span class="math inline">\(n&gt;p\)</span> or <span class="math inline">\(n\leq p\)</span>), the <code><a href="../reference/rgcca.html">rgcca()</a></code> function selects automatically the dual formulation for <span class="math inline">\(\ensuremath{\mathbf{X}}_1\)</span> and <span class="math inline">\(\ensuremath{\mathbf{X}}_2\)</span> and the primal one for <span class="math inline">\(\ensuremath{\mathbf{X}}_3\)</span>.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rgcca.glioma</span> <span class="op">=</span> <span class="fu"><a href="../reference/rgcca.html">rgcca</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">C</span>, tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, ncomp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,
                     scale <span class="op">=</span> <span class="cn">TRUE</span>, scheme <span class="op">=</span> <span class="st">"horst"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>The formulation used for each block is returned using the following command:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rgcca.glioma</span><span class="op">$</span><span class="va">primal_dual</span></code></pre></div>
<p>The dual formulation make the RGCCA algorithm highly efficient even in a high dimensional setting.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span><span class="fu"><a href="../reference/rgcca.html">rgcca</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">C</span>, tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, ncomp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,
                  scheme <span class="op">=</span> <span class="st">"horst"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<pre><code>##    user  system elapsed 
##   1.254   0.029   1.294</code></pre>
<p>As previously, RGCCA enables visual inspection of the spatial relationships between classes. This facilitates assessment of the quality of the classification and makes it possible to readily determine which components capture the discriminant information.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Loc <span class="op">=</span> <span class="va">Loc</span>,
                 GE1 <span class="op">=</span> <span class="va">rgcca.glioma</span><span class="op">$</span><span class="va">Y</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>,
                 CGH1 <span class="op">=</span> <span class="va">rgcca.glioma</span><span class="op">$</span><span class="va">Y</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>

<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df1</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">GE1</span>, <span class="va">CGH1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Factor plot (Glioma data) - GE block"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_text</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>colour <span class="op">=</span> <span class="va">Loc</span>, label<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">df1</span><span class="op">)</span><span class="op">)</span>,
            vjust<span class="op">=</span><span class="fl">0</span>,nudge_y <span class="op">=</span> <span class="fl">0.03</span>,size <span class="op">=</span> <span class="fl">3</span> <span class="op">)</span><span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"bottom"</span>, legend.box <span class="op">=</span> <span class="st">"horizontal"</span>,
        legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="va">p1</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="vignette_RGCCA_files/figure-html/unnamed-chunk-37-1.png" alt="RGCCA dual formulation. Graphical display of the tumors obtained by crossing GE1 and CGH1 and labeled according to their location." width="700"><p class="caption">
RGCCA dual formulation. Graphical display of the tumors obtained by crossing GE1 and CGH1 and labeled according to their location.
</p>
</div>
<p>In high-dimensional settings, the highest level of regularization (<span class="math inline">\(\tau_j=1\)</span>) has proven to be necessary or even insufficient. Additional penalties that promote sparsity are often required.</p>
</div>
<div id="sgcca-for-the-glioma-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#sgcca-for-the-glioma-dataset" class="anchor"></a>SGCCA for the Glioma dataset</h2>
<p>The variable selection is achieved by adding, within the RGCCA optimization problem, a penalty promoting sparsity. For that purpose, an <span class="math inline">\(\ell_1\)</span> penalization on the weight vectors <span class="math inline">\(\ensuremath{\mathbf{a}}_1, \ldots, \ensuremath{\mathbf{a}}_J\)</span> is applied. the <code>c1</code> argument of <code><a href="../reference/sgcca.html">sgcca()</a></code> vary between 0 and 1 (larger values of <code>c1</code> correspond to less penalization) and control the amount of sparsity of the weight vectors <span class="math inline">\(\ensuremath{\mathbf{a}}_1, \ldots, \ensuremath{\mathbf{a}}_J\)</span>. If <code>c1</code> is a vector, <span class="math inline">\(\ell_1\)</span>-penalties are the same for all the weights corresponding to the same block but different components:</p>
<p><span class="math display">\[\begin{equation}
\forall h, \Vert \ensuremath{\mathbf{a}}_j^{(h)} \Vert_{\ell_1} \leq c_{1j} \sqrt{p_j},
\end{equation}\]</span></p>
<p>with <span class="math inline">\(p_j\)</span> the number of variables of <span class="math inline">\(\ensuremath{\mathbf{X}}_j\)</span>.</p>
<p>If <code>c1</code> is a matrix, each row <span class="math inline">\(h\)</span> of <code>c1</code> defines the constraints applied to the weights corresponding to components <span class="math inline">\(h\)</span>:</p>
<p><span class="math display">\[\begin{equation}
\forall h, \Vert \ensuremath{\mathbf{a}}_j^{(h)} \Vert_{\ell_1} \leq c_1[h,j] \sqrt{p_j}.
\end{equation}\]</span></p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># sgcca algorithm</span>
<span class="va">sgcca.glioma</span> <span class="op">=</span> <span class="fu"><a href="../reference/sgcca.html">sgcca</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">C</span>, c1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.071</span>,<span class="fl">.2</span>, <span class="fl">1</span><span class="op">)</span>,
                     ncomp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,
                     scheme <span class="op">=</span> <span class="st">"centroid"</span>,
                     scale <span class="op">=</span> <span class="cn">TRUE</span>,
                     verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>For GE, the number of non-zero elements of <span class="math inline">\(\ensuremath{\mathbf{a}}_1\)</span> is equal to 145 and is given by</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nb_zero_GE</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">sgcca.glioma</span><span class="op">$</span><span class="va">a</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<p>For CGH, the number of non-zero elements of <span class="math inline">\(\ensuremath{\mathbf{a}}_2\)</span> is equal to 92 and is given by</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nb_zero_CGH</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">sgcca.glioma</span><span class="op">$</span><span class="va">a</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<p>One component per block has been built (GE1 for <span class="math inline">\(\ensuremath{\mathbf{X}}_1\)</span> and CGH1 <span class="math inline">\(\ensuremath{\mathbf{X}}_2\)</span>), and the graphical display of the tumors obtained by crossing GE1 and CGH1 and labeled according to their location is shown below.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Loc <span class="op">=</span> <span class="va">Loc</span>,
                 GE1 <span class="op">=</span> <span class="va">sgcca.glioma</span><span class="op">$</span><span class="va">Y</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>,
                 CGH1 <span class="op">=</span> <span class="va">sgcca.glioma</span><span class="op">$</span><span class="va">Y</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>
  
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df1</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">GE1</span>, <span class="va">CGH1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Factor plot (Glioma data)"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_text</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>colour <span class="op">=</span> <span class="va">Loc</span>, label<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">df1</span><span class="op">)</span><span class="op">)</span>,
              vjust<span class="op">=</span><span class="fl">0</span>,nudge_y <span class="op">=</span> <span class="fl">0.03</span>,size <span class="op">=</span> <span class="fl">3</span> <span class="op">)</span><span class="op">+</span>
    <span class="fu">theme</span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"bottom"</span>, legend.box <span class="op">=</span> <span class="st">"horizontal"</span>,
          legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  
<span class="va">p1</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="vignette_RGCCA_files/figure-html/unnamed-chunk-41-1.png" alt="graphical display of the tumors obtained by crossing GE1 and CGH1 land abeled according to their location." width="700"><p class="caption">
graphical display of the tumors obtained by crossing GE1 and CGH1 land abeled according to their location.
</p>
</div>
<p>We observe that the GE block contains much more discriminative information than the CGH block.</p>
<div id="sgcca-with-a-superblock" class="section level3">
<h3 class="hasAnchor">
<a href="#sgcca-with-a-superblock" class="anchor"></a>SGCCA with a superblock</h3>
<p>In this subsection we consider the between-block connections described in Figure .</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A</span> <span class="op">&lt;-</span> <span class="va">ge_cgh_locIGR</span><span class="op">$</span><span class="va">multiblocks</span>
<span class="va">Loc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">ge_cgh_locIGR</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">Loc</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">ge_cgh_locIGR</span><span class="op">$</span><span class="va">multiblocks</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>
<span class="va">A</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="va">A</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="op">-</span><span class="fl">3</span><span class="op">]</span>
<span class="va">B</span> <span class="op">=</span> <span class="va">A</span>
<span class="va">B</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span><span class="op">(</span><span class="st">"cbind"</span>, <span class="va">A</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="co"># superblock</span>
<span class="va">B</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="va">A</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">B</span>, <span class="va">dim</span><span class="op">)</span> <span class="co"># check dimension</span></code></pre></div>
<pre><code>##         GE  CGH     y   
## [1,]    53   53    53 53
## [2,] 15702 1229 16931  2</code></pre>

<p>and encoded in the design matrix as follows:</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nb_block</span> <span class="op">=</span> <span class="fl">4</span> <span class="co">#length(B)</span>
<span class="va">C</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nb_block</span>, <span class="va">nb_block</span><span class="op">)</span>
<span class="va">C</span><span class="op">[</span>, <span class="va">nb_block</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span> ; <span class="va">C</span><span class="op">[</span><span class="va">nb_block</span><span class="op">-</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">=</span> <span class="fl">1</span> ; <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">C</span><span class="op">)</span> <span class="op">=</span> <span class="fl">0</span>
<span class="va">C</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    0    0    1    0
## [2,]    0    0    1    0
## [3,]    1    1    0    1
## [4,]    0    0    1    0</code></pre>
<p>In that case, the call of <code><a href="../reference/sgcca.html">sgcca()</a></code> is as follows:</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sgcca.glioma</span> <span class="op">=</span> <span class="fu"><a href="../reference/sgcca.html">sgcca</a></span><span class="op">(</span><span class="va">B</span>, <span class="va">C</span>,
                     c1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.071</span>,<span class="fl">.2</span>, <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">NCOL</a></span><span class="op">(</span><span class="va">B</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fl">.2</span>, <span class="fl">1</span><span class="op">)</span>,
                     ncomp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>,
                     scheme <span class="op">=</span> <span class="st">"factorial"</span>, scale <span class="op">=</span> <span class="cn">TRUE</span>,
                     verbose <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
<p>and allows for the graphical representations of the individuals and the variables in a common space.</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Loc <span class="op">=</span> <span class="va">Loc</span>, <span class="va">sgcca.glioma</span><span class="op">$</span><span class="va">Y</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
  
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df1</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">comp1</span>, <span class="va">comp2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Factor plot (Glioma data) - super block"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_text</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>colour <span class="op">=</span> <span class="va">Loc</span>, label<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">df1</span><span class="op">)</span><span class="op">)</span>,
              vjust<span class="op">=</span><span class="fl">0</span>,nudge_y <span class="op">=</span> <span class="fl">0.03</span>,size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">+</span>
    <span class="fu">theme</span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"bottom"</span>, legend.box <span class="op">=</span> <span class="st">"horizontal"</span>,
          legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">p1</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="vignette_RGCCA_files/figure-html/unnamed-chunk-45-1.png" alt="factor plot - two first components of the superblock. individuals are colored according to their group membership" width="700"><p class="caption">
factor plot - two first components of the superblock. individuals are colored according to their group membership
</p>
</div>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ind.select</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">sgcca.glioma</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span>,
                           <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">!=</span><span class="fl">0</span> <span class="op">|</span> <span class="va">x</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">!=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="va">VAR.SELECT</span> <span class="op">=</span> <span class="va">B</span><span class="op">[[</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="va">ind.select</span><span class="op">]</span>
<span class="va">BLOCK</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"CGH"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">NCOL</a></span><span class="op">(</span><span class="va">VAR.SELECT</span><span class="op">)</span><span class="op">)</span>
<span class="va">BLOCK</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">VAR.SELECT</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"GE"</span>
  
<span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>comp1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">VAR.SELECT</span>, <span class="va">sgcca.glioma</span><span class="op">$</span><span class="va">Y</span><span class="op">[[</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
                comp2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">VAR.SELECT</span>, <span class="va">sgcca.glioma</span><span class="op">$</span><span class="va">Y</span><span class="op">[[</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>,
                <span class="va">BLOCK</span><span class="op">)</span>
  
<span class="co"># Circle</span>
<span class="va">circleFun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">center</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,<span class="va">diameter</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">npoints</span> <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">{</span>
    <span class="va">r</span> <span class="op">=</span> <span class="va">diameter</span> <span class="op">/</span> <span class="fl">2</span>
    <span class="va">tt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">*</span><span class="va">pi</span>,length.out <span class="op">=</span> <span class="va">npoints</span><span class="op">)</span>
    <span class="va">xx</span> <span class="op">&lt;-</span> <span class="va">center</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">r</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">tt</span><span class="op">)</span>
    <span class="va">yy</span> <span class="op">&lt;-</span> <span class="va">center</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">r</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">tt</span><span class="op">)</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">xx</span>, y <span class="op">=</span> <span class="va">yy</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
  
<span class="va">circle</span> <span class="op">&lt;-</span> <span class="fu">circleFun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fl">2</span>,npoints <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
  
<span class="va">p</span> <span class="op">&lt;-</span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">comp1</span>, <span class="va">comp2</span><span class="op">)</span>, colour <span class="op">=</span> <span class="va">BLOCK</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_path</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span>, data<span class="op">=</span><span class="va">circle</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Correlation Circle"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_text</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>colour <span class="op">=</span> <span class="va">BLOCK</span>, label<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>,
              vjust<span class="op">=</span><span class="fl">0</span>,nudge_y <span class="op">=</span> <span class="fl">0.03</span>,size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">+</span>
    <span class="fu">theme</span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"bottom"</span>, legend.box <span class="op">=</span> <span class="st">"horizontal"</span>,
          legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  
<span class="va">p</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="vignette_RGCCA_files/figure-html/unnamed-chunk-46-1.png" alt="correlation circle plot - two first components of the superblock. Variables are colored according to their block membership" width="700"><p class="caption">
correlation circle plot - two first components of the superblock. Variables are colored according to their block membership
</p>
</div>
<p>Moreover, it is possible to use a bootstrap resampling method to assess the stability of the variable selection process of SGCCA. B (e.g. 500) bootstrap samples of the same size as the original data is repeatedly sampled with replacement from the original data. SGCCA is then applied to each bootstrap sample to obtain the SGCCA estimates. The percentage of times a specific variable had a non-null weight across bootstrap sample can be derived. Work is in progress to include this function within the RGCCA package but an R code is given below.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nb_boot</span> <span class="op">=</span> <span class="fl">500</span> <span class="co"># number of bootstrap samples</span>
<span class="va">J</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span><span class="op">-</span><span class="fl">2</span>
<span class="va">STAB</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">J</span><span class="op">)</span><span class="op">)</span>
  <span class="va">STAB</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nb_boot</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">NCOL</a></span><span class="op">(</span><span class="va">B</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
  
<span class="va">c1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.071</span>,<span class="fl">.2</span>, <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">NCOL</a></span><span class="op">(</span><span class="va">B</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fl">.2</span>, <span class="fl">1</span><span class="op">)</span>
  
<span class="va">B</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">B</span>, <span class="va">cbind</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nb_boot</span><span class="op">)</span><span class="op">{</span>
  <span class="va">ind</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">NROW</a></span><span class="op">(</span><span class="va">B</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="va">Bscr</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">B</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="va">ind</span>, <span class="op">]</span><span class="op">)</span>
  <span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="../reference/sgcca.html">sgcca</a></span><span class="op">(</span><span class="va">Bscr</span>, <span class="va">C</span>, c1 <span class="op">=</span> <span class="va">c1</span>, ncomp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
              scheme <span class="op">=</span> <span class="st">"factorial"</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">J</span><span class="op">)</span><span class="op">)</span> <span class="va">STAB</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">a</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span>
<span class="op">}</span>
  
<span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">J</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">STAB</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">B</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
  
<span class="va">top</span> <span class="op">=</span> <span class="fl">30</span>
<span class="va">count</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">STAB</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">y</span><span class="op">!=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">count_sort</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">count</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">x</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The 30 top variables for GE and CGH are represented below:</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stabGE</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>GE_symbol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">count_sort</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">top</span><span class="op">]</span>,
                    Count <span class="op">=</span> <span class="va">count_sort</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">top</span><span class="op">]</span><span class="op">/</span><span class="va">nb_boot</span><span class="op">)</span>

<span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">stabGE</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">GE_symbol</span>, <span class="va">Count</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">Count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span>
<span class="va">g1</span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stabCGH</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>CGH_symbol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">count_sort</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">top</span><span class="op">]</span>,
                     Count <span class="op">=</span> <span class="va">count_sort</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">top</span><span class="op">]</span><span class="op">/</span><span class="va">nb_boot</span><span class="op">)</span>
  
<span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">stabCGH</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">CGH_symbol</span>, <span class="va">Count</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">Count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span>
<span class="va">g2</span></code></pre></div>
<p>At last, the McKeon’s measure quantifies the homogeneity of a set of block components and is defined by the following formula:</p>
<p><span class="math display">\[\begin{equation}
\displaystyle r_I(\ensuremath{\mathbf{X}}_1 \ensuremath{\mathbf{a}}_1, \ldots, \ensuremath{\mathbf{X}}_J \ensuremath{\mathbf{a}}_J )=\frac{\frac{1}{(J(J-1)/2}\sum_{j&lt;k} \mathrm{cov}(\ensuremath{\mathbf{X}}_j \ensuremath{\mathbf{a}}_j,\ensuremath{\mathbf{X}}_k \ensuremath{\mathbf{a}}_k)}{1/J \sum_j \mathrm{var}(\ensuremath{\mathbf{X}}_j \ensuremath{\mathbf{a}}_j)}
  \label{mckeon}
\end{equation}\]</span></p>
<p>Formula () allows evaluating the homogeneity of the solution of any multiblock component methods. The McKeon measure (not yet implemented within the RGCCA package but easily derived from the <code><a href="../reference/rgcca.html">rgcca()</a></code> function, see below) can be used to evaluate the proximities of the <span class="math inline">\(3\)</span> blocks. The computation of the McKeon’s measure was carried out using RGCCA (full between-block connections, <span class="math inline">\(\tau_j=1\)</span> for all blocks, and <span class="math inline">\(g(x) = x\)</span> for a fair analysis).</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rI</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">{</span>
    <span class="va">J</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>
    <span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="../reference/rgcca.html">rgcca</a></span><span class="op">(</span><span class="va">A</span>, scale <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
    <span class="va">Y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span><span class="op">(</span><span class="st">"cbind"</span>, <span class="va">res</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span>
    <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">J</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="../reference/cov2.html">cov2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">Y</span>, <span class="fl">2</span>, <span class="va">cov2</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>
<span class="op">}</span>
  
  
<span class="va">X1</span> <span class="op">=</span> <span class="va">B</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">sgcca.glioma</span><span class="op">$</span><span class="va">a</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">!=</span><span class="fl">0</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">]</span>
<span class="va">X2</span> <span class="op">=</span> <span class="va">B</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">sgcca.glioma</span><span class="op">$</span><span class="va">a</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">!=</span><span class="fl">0</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">]</span>
<span class="va">X3</span> <span class="op">=</span> <span class="va">B</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>
<span class="va">A</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>GE <span class="op">=</span> <span class="va">X1</span>, CGH <span class="op">=</span> <span class="va">X2</span>, LOC <span class="op">=</span> <span class="va">X3</span><span class="op">)</span>
  
<span class="va">J</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>
<span class="va">M</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">J</span>, <span class="va">J</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">J</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="va">i</span><span class="op">:</span><span class="va">J</span><span class="op">)</span><span class="op">{</span>
    <span class="va">M</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span> <span class="op">=</span> <span class="fu">rI</span><span class="op">(</span><span class="va">A</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">j</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
    <span class="va">M</span><span class="op">[</span><span class="va">j</span>, <span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">M</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span>
  <span class="op">}</span>
<span class="op">}</span>
  
<span class="va">M</span></code></pre></div>
<pre><code>##            GE       CGH       LOC
## GE  1.0000000 0.6687405 0.7886705
## CGH 0.6687405 1.0000000 0.3741627
## LOC 0.7886705 0.3741627 1.0000000</code></pre>
<p>This suggests that the tumor location in the brain is more dependent on gene expression than on chromosomal imbalances and that this dependency is stronger that the dependency between gene expression and chromosomal imbalances.</p>
</div>
</div>
</div>
<div id="conclusion" class="section level1">
<h1 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h1>
<p>This package gathers fifty years of multiblock component methods and offers a unified implementation stategy for these methods. Work is in progress to include within the RGCCA package:</p>
<ul>
<li><p>a function that fully implements the cross validation procedure.</p></li>
<li><p>a bootstrap resampling procedure for assessing the realiability of the parameters estimates of RGCCA and the stability of the selected variables for SGCCA.</p></li>
<li><p>Dedicated functions for graphical representations of the ouptut of RGCCA (factor plot, correlation circle).</p></li>
<li><p>multiblock data faces two types of missing data structure: (i) if an observation i has missing values on a whole block j and (ii) if an observation i has some missing values on a block j (but not all). For these two situations, it is possible to exploit the algorithmic solution proposed for PLS path modeling to deal with missing data (see <span class="citation">(Tenenhaus et al. 2005)</span>, page 171). Work is in progress to implement this missing data solution within the RGCCA package.</p></li>
<li><p>At last, RGCCA for multigroup data <span class="citation">(A. Tenenhaus et al. 2014)</span> and for multiway data <span class="citation">(Arthur Tenenhaus, Le Brusquet, and Lechuga 2015)</span> has been proposed but not yet implemented in the RGGCA package. These two methods remain to be integrated into the package.</p></li>
</ul>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-Borga1997">
<p>Borga, M., T. Landelius, and H. Knutsson. 1997. “A Unified Approach to PCA, PLS, MLR and CCA.”</p>
</div>
<div id="ref-Bougeard2008">
<p>Bougeard, S., M. Hanafi, and E.M. Qannari. 2008. “Continuum redundancy-PLS regression: a simple continuum approach.” <em>Computational Statistics and Data Analysis</em> 52: 3686–96.</p>
</div>
<div id="ref-Burnham1996">
<p>Burnham, A.J., R. Viveros, and J.F. MacGregor. 1996. “Frameworks for latent variable multivariate regression.” <em>Journal of Chemometrics</em> 10: 31–45.</p>
</div>
<div id="ref-Carroll1968a">
<p>Carroll, J.D. 1968. “A generalization of canonical correlation analysis to three or more sets of variables.” In <em>Proceeding 76th Conv. Am. Psych. Assoc.</em>, 227–28.</p>
</div>
<div id="ref-Carroll1968b">
<p>Carroll, JD. 1968. “Equations and Tables for a Generalization of Canonical Correlation Analysis to Three or More Sets of Variables.” <em>Unpublished Companion Paper to Carroll, JD</em>.</p>
</div>
<div id="ref-Chessel1996">
<p>Chessel, D., and M. Hanafi. 1996. “Analyse de la co-inertie de K nuages de points.” <em>Revue de Statistique Appliquée</em> 44: 35–60.</p>
</div>
<div id="ref-Gifi1990">
<p>Gifi, A. 1990. <em>Nonlinear multivariate analysis</em>. John Wiley &amp; Sons, Chichester, UK.</p>
</div>
<div id="ref-Hanafi2007">
<p>Hanafi, M. 2007. “PLS Path modelling: computation of latent variables with the estimation mode B.” <em>Computational Statistics</em> 22: 275–92.</p>
</div>
<div id="ref-Hanafi2006">
<p>Hanafi, M., and H.A.L. Kiers. 2006. “Analysis of K sets of data, with differential emphasis on agreement between and within sets.” <em>Computational Statistics and Data Analysis</em> 51: 1491–1508.</p>
</div>
<div id="ref-Horst1961">
<p>Horst, P. 1961. “Relations among m sets of variables.” <em>Psychometrika</em> 26: 126–49.</p>
</div>
<div id="ref-Hotelling1936">
<p>Hotelling, H. 1936. “Relation Between Two Sets of Variates.” <em>Biometrika</em> 28: 321–77.</p>
</div>
<div id="ref-Kettenring1971">
<p>Kettenring, J. R. 1971. “Canonical analysis of several sets of variables.” <em>Biometrika</em> 58: 433–51.</p>
</div>
<div id="ref-Kramer2007">
<p>Kramer, N. 2007. “Analysis of high-dimensional data with partial least squares and boosting.” In <em>Doctoral dissertation, Technischen Universitat Berlin</em>.</p>
</div>
<div id="ref-Puget2012">
<p>Puget, S., C. Philippe, D. A Bax, B. Job, P. Varlet, M.-P. Junier, F. Andreiuolo, et al. 2012. “Mesenchymal transition and PDGFRA amplification/mutation are key distinct oncogenic events in pediatric diffuse intrinsic pontine gliomas.” <em>PloS One</em> 7 (2): e30313.</p>
</div>
<div id="ref-Qannari2005">
<p>Qannari, E.M., and M. Hanafi. 2005. “A simple continuum regression approach.” <em>Journal of Chemometrics</em> 19: 387–92.</p>
</div>
<div id="ref-Russett1964">
<p>Russett, B.M. 1964. “Inequality and Instability: The Relation of Land Tenure to Politics.” <em>World Politics</em> 16:3: 442–54.</p>
</div>
<div id="ref-Schafer2005">
<p>Schäfer, J., and K. Strimmer. 2005. “A shrinkage approach to large-scale covariance matrix estimation and implications for functional genomics.” <em>Statistical Applications in Genetics and Molecular Biology</em> 4 (1): Article 32.</p>
</div>
<div id="ref-Shawe2004">
<p>Shawe-Taylor, J., and N. Cristianini. 2004. <em>Kernel Methods for Pattern Analysis</em>. Cambridge University Press, New York, NY, USA.</p>
</div>
<div id="ref-Takane2007">
<p>Takane, Y., and H. Hwang. 2007. “Regularized linear and kernel redundancy analysis.” <em>Computational Statistics and Data Analysis</em> 52: 394–405.</p>
</div>
<div id="ref-Tenenhaus2014b">
<p>Tenenhaus, A., C. Philippe, V. Guillemot, K.-A. Lê Cao, J. Grill, and V. Frouin. 2014. “Variable Selection for Generalized Canonical Correlation Analysis.” <em>Biostatistics</em> 15(3): 569–83.</p>
</div>
<div id="ref-Tenenhaus2015c">
<p>Tenenhaus, Arthur, Laurent Le Brusquet, and Gisela Lechuga. 2015. “Multiway Regularized Generalized Canonical Correlation Analysis.” In <em>47ème Journées de Statistique, Lille, France</em>.</p>
</div>
<div id="ref-Tenenhaus2015">
<p>Tenenhaus, Arthur, Cathy Philippe, and Vincent Frouin. 2015. “Kernel Generalized Canonical Correlation Analysis.” <em>Computational Statistics &amp; Data Analysis</em> 90: 114–31.</p>
</div>
<div id="ref-Tenenhaus2011">
<p>Tenenhaus, A., and M. Tenenhaus. 2011. “Regularized Generalized Canonical Correlation Analysis.” <em>Psychometrika</em> 76: 257–84.</p>
</div>
<div id="ref-Tenenhaus2014">
<p>———. 2014. “Regularized Generalized Canonical Correlation Analysis for multiblock or multigroup data analysis.” <em>European Journal of Operational Research</em> 238: 391–403.</p>
</div>
<div id="ref-Tenenhaus2005">
<p>Tenenhaus, M., V. Esposito Vinzi, Y.-M. Chatelin, and C. Lauro. 2005. “PLS path modeling.” <em>Computational Statistics and Data Analysis</em> 48: 159–205.</p>
</div>
<div id="ref-Tenenhaus2017">
<p>Tenenhaus, M., A. Tenenhaus, and PJF. Groenen. 2017. “Regularized generalized canonical correlation analysis: A framework for sequential multiblock component methods.” <em>Psychometrika</em>, in press.</p>
</div>
<div id="ref-Tucker1958">
<p>Tucker, L.R. 1958. “An inter-battery method of factor analysis.” <em>Psychometrika</em> 23: 111–36.</p>
</div>
<div id="ref-VandeGeer1984">
<p>Van de Geer, J.P. 1984. “Linear relations among k sets of variables.” <em>Psychometrika</em> 49: 70–94.</p>
</div>
<div id="ref-Wollenberg1977">
<p>Van den Wollenberg, A.L. 1977. “Redudancy analysis: an alternative for canonical correlation analysis.” <em>Psychometrika</em> 42: 207–19.</p>
</div>
<div id="ref-Vinod1976">
<p>Vinod, H.D. 1976. “Canonical ridge and econometrics of joint production.” <em>Journal of Econometrics</em> 4: 147–66.</p>
</div>
<div id="ref-Westerhuis1998">
<p>Westerhuis, J.A, T. Kourti, and J.F. MacGregor. 1998. “Analysis of multiblock and hierarchical PCA and PLS models.” <em>Journal of Chemometrics</em> 12: 301–21.</p>
</div>
<div id="ref-Wold1982">
<p>Wold, H. 1982. “Soft Modeling: The Basic Design and Some Extensions.” In <em>in Systems under indirect observation, Part 2, K.G. Jöreskog and H. Wold (Eds), North-Holland, Amsterdam</em>, 1–54.</p>
</div>
<div id="ref-Wold1996">
<p>Wold, S. and Kettaneh, N. and Tjessem, K.. 1996. “Hierarchical multiblock PLS and PC models for easier model interpretation and as an alternative to variable selection.” <em>Journal of Chemometrics</em> 10: 463–82.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Arthur Tenenhaus, Vincent Guillemot, Lluís Revilla Sancho.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
